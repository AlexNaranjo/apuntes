\documentclass{apuntes}

\title{Economia}
\author{Pedro Valero}
\date{15/16 C2}

% Paquetes adicionales
\usepackage{pgf}
\usepackage{tikz}
\usetikzlibrary{arrows,automata}
\usepackage{eurosym}
\usepackage{listings}

\let\oldeuro\euro
\renewcommand{\texteuro}{\oldeuro\xspace}

% --------------------

\begin{document}
\pagestyle{plain}

\begin{abstract}
Estos apuntes corresponden a la asignatura ``Economía y finanzas matemáticas'' impartida por el profesor Santiago Carrillo en la Facultad de Ciencias de la Universidad Autónoma de Madrid.

Mientras que las matemáticas desarrolladas en este curso son de un nivel básico (para un alumno de último curso de Matemáticas) será importante comprender los conceptos a los que aplicaremos estos conceptos.

En este documento se recogen los ejercicios realizados durante el desarrollo de la asignatura haciendo referencia, siempre que sea necesario, a los contenidos teóricos vistos en clase y que pueden encontrarse en las transparencias de la asignatura, disponibles en moodle.
\end{abstract}

\maketitle

\tableofcontents
\newpage
% Contenido.

%% Apéndices (ejercicios, exámenes)
\appendix

\chapter{Prácticas}
\section{Introducción}
Se realizarán cuatro prácticas a lo largo del curso de las cuales se considerarán las tres mejores, que podrán subir la nota final pero nunca bajarla.

Estas prácticas se desarrollarán en excel, por ser lo más utilizado en los bancos hoy en día. Para la realización de estas prácticas se asignarán un total de 8 horas de clase, que serán reducidas del horario general, divididas en 4 clases de 2 horas.

\chapter{Ejercicios}
\input{tex/Economia_Ejs.tex}

\chapter{Scripts de python}
\section{Árboles binomiales}\label{sec:arbolBin}

% Default fixed font does not support bold face
\DeclareFixedFont{\ttb}{T1}{txtt}{bx}{n}{12} % for bold
\DeclareFixedFont{\ttm}{T1}{txtt}{m}{n}{12}  % for normal

% Custom colors
\definecolor{deepblue}{rgb}{0,0,0.5}
\definecolor{deepred}{rgb}{0.6,0,0}
\definecolor{deepgreen}{rgb}{0,0.5,0}

\lstset{language=Python,
	basicstyle=\ttm,
	otherkeywords={self},             % Add keywords here
	keywordstyle=\ttb\color{deepblue},
	emph={MyClass,__init__},          % Custom highlighting
	emphstyle=\ttb\color{deepred},    % Custom highlighting style
	stringstyle=\color{deepgreen},
	frame=tb,                         % Any extra options here
	showstringspaces=false,
    tabsize=4,
    breaklines=true
}


\begin{lstlisting}
#! /usr/bin/python
import math
import random

def computeValueSTMinusMin(path, a, b, p, S0, barrera, K):
	prob = 1
	value = S0
	minimum = S0

	for i in path:
		if i == a:
			prob = prob * p
		elif i == b:
			prob = prob *(1-p)
		else:
			print "Some error occurs"

		value = value * i
		if value < minimum:
			minimum = value

	return (value - minimum) * prob


def computeValueMaxMinusST(path, a, b, p, S0, barrera, K):
	prob = 1
	value = S0
	maximum = S0

	for i in path:
		if i == a:
			prob = prob * p
		elif i == b:
			prob = prob *(1-p)
		else:
			print "Some error occurs"

		value = value * i
		if value > maximum:
			maximum = value

	return (maximum - value) * prob


def computeValueCallBarreraUp_Out(path, a, b, p, S0, barrera, K):
	prob = 1
	value = S0

	for i in path:
		if value >= barrera:
			value = 0
			break
		elif i == a:
			prob = prob * p
		elif i == b:
			prob = prob *(1-p)
		else:
			print "Some error occurs"

		value = value * i

	if (value - S0) >= 0:
		return (value - S0) * prob
	else:
		return 0


def computeValueCallBarreraUp_In(path, a, b, p, S0, barrera, K):
	prob = 1
	value = S0
	flag = False

	for i in path:
		if value >= barrera:
			flag = True
		elif i == a:
			prob = prob * p
		elif i == b:
			prob = prob *(1-p)
		else:
			print "Some error occurs"

		value = value * i

	if flag:
		if (value - S0) >= 0:
			return (value - S0) * prob
		else:
			return 0
	else:
		return 0


def computeValuePutBarreraDown_Out(path, a, b, p, S0, barrera, K):
	prob = 1
	value = S0

	for i in path:
		if value <= barrera:
			value = 0
			break
		elif i == a:
			prob = prob * p
		elif i == b:
			prob = prob *(1-p)
		else:
			print "Some error occurs"

		value = value * i

	if (S0 - value) >= 0:
		return (S0 - value) * prob
	else:
		return 0


def computeValuePutBarreraDown_In(path, a, b, p, S0, barrera, K):
	prob = 1
	value = S0
	flag = False

	for i in path:
		if value <= barrera:
			flag = True
		elif i == a:
			prob = prob * p
		elif i == b:
			prob = prob *(1-p)
		else:
			print "Some error occurs"

		value = value * i

	if flag:
		if (S0 - value) >= 0:
			return (S0 - value) * prob
		else:
			return 0
	else:
		return 0


def computeValueCallAsiatica(path, a, b, p, S0, barrera, K):
	prob = 1
	value = S0
	media = S0
	string = ""

	for i in path:
		if value <= barrera:
			flag = True
		elif i == a:
			prob = prob * p
			string = string + "a"
		elif i == b:
			prob = prob *(1-p)
			string = string + "b"
		else:
			print "Some error occurs"

		value = value * i
		media = media + value

	media = media / len(path)

	if (media - K) >= 0:
		print string, " & ",  str("{:.4f}".format(media-K)), " & ", str("{:.4f}".format(prob)), " \\\\"
		return (media - K) * prob
	else:
		print string, " & 0 & ", str("{:.4f}".format(prob)), " \\\\"
		return 0


def compute_future_value_binary_tree(a,b,p,T,S0,func, barrera, K):
	trajectory = []

	trajectory.append([a])
	trajectory.append([b])

	finalValue = 0

	for path in trajectory:
		if len(path) == T:
			finalValue = finalValue + func(path, a, b, p, S0, barrera, K)
		else:
			pathA = list(path)
			pathA.append(a)
			pathB = list(path)
			pathB.append(b)
			trajectory.append(pathA)
			trajectory.append(pathB)


	return finalValue


print compute_future_value_binary_tree(1.08,0.93,0.5,10,12,computeValueCallBarreraUp_Out, 1.08**8*12, 12)

print compute_future_value_binary_tree(1.08,0.93,0.5,10,12,computeValueCallBarreraUp_In, 1.08**8*12, 12)

print compute_future_value_binary_tree(1.08,0.93,0.5,10,12,computeValuePutBarreraDown_Out, 1.08**(-8)*12, 12)

print compute_future_value_binary_tree(1.08,0.93,0.5,10,12,computeValuePutBarreraDown_In, 1.08**(-8)*12, 12)

print compute_future_value_binary_tree(1.08,0.93,0.53,6,10,computeValueCallAsiatica, 0, 10)
\end{lstlisting}

\printindex
\end{document}
