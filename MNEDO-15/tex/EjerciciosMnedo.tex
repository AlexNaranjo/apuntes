% -*- root: ../mnedo.tex -*-
\section{Hoja 1}
\begin{problem}[1]
Considerar el PVI:
\[\left\{ y'=f(t) \ t \in [t_0,T] \atop
y(t_0)=0
\right.\]

Probar que utilizando el método de Euler:
\[y_N=\sum_{k=0}^{N-1} f(t_k)h\]
\solution

Recordamos que el método de Euler consiste en emplear
\[y_{n+1} = y_n + h f(t_n)\]

Por inducción podemos resolverlo:

\begin{equation*}
	\begin{multlined}[0.8\textwidth]
		\underline{n=0}: \quad y_1=y_0+h(t_0) = h(t_0)\\[1em]
		\shoveleft{\underline{n=1}: \quad y_2 = y_1 + hf(t_1) = hf(t_0) + hf(t_1)}\\
		\shoveleft{\qquad \qquad \quad = h\left[ f(t_0) + f(t_1) \right]}\\
	\end{multlined}
\end{equation*}

La hipótesis de inducción es para $N-1$: $y_N = \sum_{k=0}^{N-1} f(t_k)h$. Así que solo nos falta demostrar que se cumple en $N$:
\begin{equation*}
	\begin{multlined}[0.8\textwidth]
		\underline{n=N}: \quad y_{N+1} = y_N + hf(t_N) = \sum_{k=0}^{N-1} f(t_k)h + hf(t_N) = \sum_{k=0}^N f(t_k)h
	\end{multlined}
\end{equation*}

\end{problem}

\begin{problem}[5]
Dado $α \in [0,1]$ encontrar el orden del método:
\[y_{n+1} = y_n +hf(t_n+(1-α)h, αy_n+(1-α)y_{n+1})\]

\solution

Lo que debemos hacer es calcular el residuo cuya definición, recordemos, era:

\textcircled{$f_n$}

\begin{defn}[Residuo]
Cuánto de lejos está la solución de satisfacer en un paso la fórmula de recurrencia
\end{defn}

Según esta definición, nuestro residuo será:
\[R_n = \underbrace{y(t_{t+1})}_{\color{orange} 1} - \left\{ \underbrace{y(t_n)}_{\color{orange} 2} + \underbrace{hf(t_n+(1-α)h, αy(t_n)+(1-α)y(t_{n+1}))}_{\color{orange} 3} \right\}\]

Para conocer el orden de este residuo vamos a calcular los siguientes desarrollos de Taylor:
\[y(t_{n+1}) = y(t_n)+y'(t_n)h + y''(t_n)\frac{h^2}{2} + O(h^3)\]

% TODO - tengo que completar algunas cuentas que no están copiadas

\[h\left( f(t_n,y(t_n))+\underbrace{f_x(t_n,y(t_n))\cdot (1-α)h +\underbrace{f_y(t_n,y(t_n))(1-α)h\left( y'(t_n)+y''(t_n)\frac{h}{2}+o(h^2)\right)}_{f_y(t_n,y(t_n))y'(t_n)(1-α)h + o(h^2)}}_{(1-α)h y''(t_n) + o(h^2)}\right) = \]

\[=hy'(t_n)+(1-α)h^2y''(t_n)+o(h^3)\]

Finalmente llegamos a
\[R_n = y''(t_n)h^2 \left(\frac{1}{2}-(1-α) \right)+o(h^3)\]

Ahora tenemos dos casos posibles:
\begin{itemize}
\item α=1/2
\[R_n=o(h^3) \implies \text{ orden } \geq 1\]
\item α$\neq$1/2
\[R_n = y''(t_n)h^2 \left(\frac{1}{2}-(1-α) \right) \implies \text{ orden } 1\]
\end{itemize}

\end{problem}