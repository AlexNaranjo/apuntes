% -*- root: ../GeometriaDiferencial.tex -*-
\chapter{Integración en variedades: teorema de Stokes}
\label{chapIntegracion}

Ahora lo que vamos a querer va a ser integrar en variedades. La cuestión es que tenemos un problema: las variedades se definen ``a cachos'', usando cartas (ver definición de variedad en \ref{defVariedadDiferenciable}). Luego vamos a tener que adaptar las integrales que ya conocemos para que funcionen bien en las cartas. Necesitaremos entonces las particiones de la unidad: una forma de decir cuánto peso le damos a cada carta en cada punto para que todo sea continuo, bonito y magnífico.

\section{Particiones de la unidad}

\begin{figure}[hbtp]
\centering
\inputtikz{IV_ParticionesUnidad}
\caption{Las ``montañas'' son las particiones $ρ_i$ de la unidad que buscamos, funciones que para cada $U_i$ (el disco debajo de cada montaña) nos dan una ponderación determinada, de tal forma que la suma de todos los $ρ_i$ en un determinado punto es uno. Si estamos en un punto de la variedad que sólo está cubierto por una carta, entonces $ρ_i(x) = 1$. Si hay varias cartas, la unidad se divide dando un peso determinado a la partición de cada carta.}
\label{figParticionesUnidad}
\end{figure}

\begin{defn}[Partición\IS de la unidad] Una partición de la unidad subordinada a un cubrimiento de cartas $U_i$ de una variedad $X = \bigcup U_i$ es una familia de funciones $ρ_i ∈ C^∞(X)$ tales que \begin{itemize}
\item $1 ≥ ρ_i ≥ 0$.
\item $\mop{sop} ρ_i ⊂ U_i$.\footnote{El soporte de $ρ_i$ es la clausura del conjunto de puntos en los que $ρ_i$ no es nula. Ver definición \ref{defSoporte}.}
\item $\sum_i ρ_i (x) = 1\quad ∀x∈X$.
\end{itemize}
\label{defParticionUnidad}
\end{defn}

Para que esta definición tenga sentido, tiene que ocurrir que en todo punto sólo haya una cantidad finita de $ρ_i$ que no tengan valor nulo. Por facilitarnos las cosas, supondremos que $X$ es variedad compacta y que por lo tanto el cubrimiento $\set{U_i}_{i=1}^N$ es finito.

Usaremos las particiones de la unidad para pasar de información local a información global. Localmente, las variedades sólo son abiertos de $ℝ^n$, pero globalmente no son triviales.

Suponemos de momento que las particiones de la unidad existen en ciertas condiciones, y vamos a ver un ejemplo algo tonto. Queremos demostrar que si $X$ es una variedad compacta, existe en $X$ un campo $D$ que no es idénticamente nulo.

Tomamos un abierto $U_1 ⊂ X$ con coordenadas $x_1, \dotsc, x_n$. Un campo no nulo sería $D = \dpa{}{x_1}$. La cuestión es que este campo es local, sólo está definido en una carta, no en toda la variedad. Queremos extenderlo a $X$ de tal forma que no sea nulo en todo punto de $X$.

Lo que hacemos es tomar un cubrimiento que contenga a $U_1$ y hallamos una partición de la unidad subordinada a este cubrimiento. Tendremos entonces una función $ρ_1 ∈ C^∞(X)$ que es nula fuera de $U_1$ (segunda condición de partición), así que \[ \hat{D} ≝ ρ_1 D\] es un campo continuo definido en todo $X$ y que no es nulo en $U_1$.

\seprule

Para demostrar el teorema de existencia de particiones de la unidad, necesitaremos lemas adicionales.

\begin{lemma} Existe $\appl{φ}{\bola_3(0)}{ℝ}$, con $C^∞$ y  $\bola_3(0) ⊂ ℝ^n$, tal que
\begin{itemize}
\item $φ(p) = 1$ si $p ∈ \bola_1(0)$.
\item $φ(p) ∈ (0,1]$ si $p ∈ \bola_2 (0)$.
\item $φ(p) = 0$ si $p ∈ \bola_3(0) \setminus \bola_2 (0)$.
\end{itemize}
\end{lemma}

Esta función φ es una función ``meseta'' porque parece una meseta: el centro está elevado, luego baja y luego es cero. Un pequeño apunte es que estas funciones no son analíticas, así que si quisiésemos extender esto a varaible compleja lo tendríamos más difícil.

\begin{figure}[hbtp]
\centering
\inputtikz{IV_LemaI}
\caption{Esta es la función ``media meseta'' definida como β en la demostración}
\label{figIV_Lema1}
\end{figure}

\begin{proof}
Sea \[ α(t) ≝ e^{-\frac{1}{(t+1)^2(t+2)^2}} \] con $t ∈ (-2, -1)$ y $α(t)= 0$ en otro caso. Definimos también su integral \[ γ(t) ≝ \int_{-∞}^t α(s) \dif s \] y el valor en todo el intervalo \[ A = \int_{-2}^{-1}α(s) \dif s \]. Por último, haremos una ``normalización'' de la integral: $β(t) ≝ \frac{γ(t)}{A}$.

Esta función $β$ va a tener forma de ``media meseta'' (ver figura \ref{figIV_Lema1}), lo que podemos usar para construir la $φ$ que buscamos. De hecho, definiremos \[ φ(\vx) ≝ β(-\md{\vx}) \] con $\vx ∈ ℝ^n$.
\end{proof}

Con esto vamos a poder demostrar el teorema.

\begin{proof}
Tomamos, para $x∈X$, funciones $\appl{f_x}{\bola_3(0)}{X}$ tales que \[ f_x(\bola_3(0)) ≝ V_x ⊂ U_i \] (lema 2 que no he copiado). Se define ahora $w_x ≝ f_x(\bola_1(0)) ⊂ V_x ⊂ U_i$. Tenemos una colección no numerable de $w_x$, pero por compacidad puedo quedarme con un conjunto finito $\set{w_i}_{i=1}^N$ que recubren toda la variedad.

Definimos entonces las funciones \[ θ_i ≝ \appl{φ○\inv{f_i}}{V_i}{ℝ} \], que serían las ``mesetas'' en los abiertos $U_1$. En ese caso, ya tenemos las $φ_i$ dadas por \[ φ_i ≝ \frac{θ_i}{\sum_{j=1}^N θ_j}\]
\end{proof}

\section{Integración}

Para integrar, lo que haremos será integrar $n$-formas $ω$ en variedades $X$ $n$-dimensionales. Lo primero que queremos hacer es definir una expresión como $\int_X ω$. Lo más fácil es ir caso a caso.

Supondremos en esta sección $X$ compacta para tener soportes compactos y $ω$ como $n$-formas dadas por \[ ω = a_1(x_1, \dotsc, x_n) \dfl{x_1}{x_n} \]

El caso más fácil es cuando el soporte (ver definición en \ref{defSoporte}) está en una única carta, esto es, $\mop{sop}ω ⊂ U_i$. Entonces no hay ambigüedad para definir la integral. Tendremos una parametrización $\appl{f_i}{D ⊂ X ⊂ ℝ^n}{U_i}$ de la carta, luego definiremos la integral como \( \int_X ω ≝ \int_U f_i^* ω = \int_{ℝ^n} a_1(x_1, \dotsc, x_n) \dfl{x_1}{x_n} \label{eqIntegralCartas}\)

El caso interesante es cuando está en dos cartas o más. Aquí hay que dar una definición que no dependa\footnote{Y así ha dejado la frase. Entiendo que se refiere a la carta que tomemos}

Aquí, tenemos que el soporte $K = \mop{sop} ω$ está en dos cartas, esto es, $k ⊂ U_i ∩ U_j$. Tenemos las dos parametrizaciones correspondientes $f_i, f_j$. Según lo que hemos escrito en el caso anterior, querríamos decir que \[ \int_X ω ≝ \int_{ℝ^n} f_i^* ω \qeq \int_{ℝ^n} f_j^* ω \]

La cuestión es que tenemos que demostrar que esas dos integrales son iguales. Para ello, vemos que las dos formas $f_i^* ω, f_j^* ω$ están relacionadas por el difeomorfismo de cambio de variable: \[ \left(\inv{f_j} ○ f_i\right)^* \left(f_j^* ω\right) = f_i^* ω\], cosa que ya está vista\footnote{¿Dónde? Vaya usted a saber.}. Sabemos además que $\inv{f_j} ○ f_i$ es un difeomorfismo.

Queremos aplicar ahora la fórmula de cambio de variable que nos dice que, dada ciertas condiciones sobre $\appl{F}{V⊂ℝ^n}{U⊂ℝ^n}$, tenemos que \[ \int_V F^* ω = \int_U ω\], una fórmula que incluye el jacobiano que conocemos de cursos de cálculo. Pero hay un problema ahí: el jacobiano saca el valor absoluto del determinante. Es decir, que en realidad la fórmula es \begin{multline} \int_{ℝ^n} a_1(y_1(x_1, \dotsc, x_n), \dotsc) \abs{\det F^*} \dfl{y_1}{y_n} = \\ = \int_{ℝ^n} a_1(y_1, \dotsc, y_n) \dfl{y_1}{y_n} \label{eqJacobianoIntegral} \end{multline}

Luego, para que \eqref{eqIntegralCartas} se cumpla, no puede cambiar el signo del jacobiano. Si tenemos múltiples cartas en un entorno, los jacobianos tienen que tener todos el mismo signo. Así, llegamos a la definición de orientable:

\begin{defn}[Orientable] Se dice que una variedad es orientable si, y sólo si, existe un atlas tal que el jacobiano entre todas sus cartas tiene el mismo signo. Por convención, tomaremos signo positivo.
\end{defn}

Necesitaremos entonces que la variedad sea orientable para poder definir bien la integral en \eqref{eqIntegralCartas}, ya que en ese caso el determinante en \eqref{eqJacobianoIntegral} se puede quitar sin problemas. Por concretar notación, dos definiciones.

\begin{defn}[Orientación] Una orientación es un atlas orientable.
\end{defn}

\begin{defn}[Orientación\IS compatible] Diremos que dos orientaciones o atlas orientables son compatibles si el jacobiano del cambio entre cualquier carta de cada atlas tiene signo positivo.
\end{defn}

Ahora que ya sabemos cómo integrar en cualquier abierto que esté contenido en una o varias cartas, sólo nos falta combinar todo ello para integrar en una variedad entera, usando las particiones de la unidad de la sección anterior.

\begin{defn}[Integración\IS de $n$-formas] Dada $X$ una variedad $n$-dimensional compacta y orientable y $ω$ una $n$-forma en $X$, se define la integral de $ω$ en $X$ como \[ \int_X ω ≝ \sum_i  \int_{U_i} ρ_i ω\] donde $\set{(U_i ρ_i)}$ es una partición de la unidad (ver \ref{defParticionUnidad}). \label{defIntegracionNForma}
\end{defn}

Nos falta ver, eso sí, que la integral no depende de la elección de la partición de la unidad. Suponemos que existen dos particiones $\set{(U_i, ρ_i)}, \set{(V_j, τ_j)}$. Entonces \[ \int_X ω ≝ \sum_i  \int ρ_i ω = \sum_i \int_X ρ_i \underbrace{\left(\sum_j τ_j\right)}_{ = 1} ω = \sum_j \left(\int_X τ_j \underbrace{\left(\sum_i ρ_i\right)}_{ = 1} ω \right) = \sum_j \int_X τ_j ω \]

Una cosa que hay que notar es que uno no va a calcular muchas integrales con esta definición. El uso de todo esto es teórico, no vamos a hacer muchos ejercicios de esto porque es un lío y no hay quién lo calcule.

Conceptualmente, eso sí, es importante, de forma similar a la integración por partes. El teorema de Stokes es la generalización más importante de la regla de Barrow\footnote{Creo que se refiere al teorema fundamental del cálculo pero no lo estoy mirando.}, que se usa mucho en cálculo; y de la misma forma usaremos el análogo partiendo de Stokes en Geometría y análisis de variedades.

\subsection{Orientación}

\hfill \textit{Aviso a navegantes: esta sección es una puta mierda.}

Vamos a revisar algunos comentarios sobre la orientabilidad. ¿Qué es orientar $ℝ^n$? ¿Cómo orientamos un espacio vectorial? Si tomamos $E = ℝ^n = \gen{e_1, \dotsc, e_n}$, entonces habíamos visto que $Λ^n E$ era un espacio vectorial de dimensión $1$, isomorfo no canónicamente a $ℝ^n$ y con base $Λ^n E = \gen{e_1 \y \dotsb \y e_n}$.

Entonces, orientar el plano es una forma de distinguir entre dos sentidos de giro de nosequé dos vectores. Lo más importante que permite es poder decir qué significa la rotación de un cierto ángulo. Las rotaciones son isometrías del producto escalar. Si digo que hago la rotación de ángulo $π/2$, ¿giro para arriba o para abajo? Elegir la orientación es decir, por ejemplo, que la orientación es la dada por el vector $e_1 \y e_2$\footnote{No sé qué cojones es eso en $ℝ^2$} y eso es girar para arriba.

En $ℝ^3$ el giro está dado por un plano, entonces la orientación la da el vector $e_1 \y e_2 \y e_3$ y tenemos el eje de giro $e_3$ y entonces está yoqueséqué bien definido.

En variedades, es lo mismo. Es decir, dar en cada punto un sentido de giro alrededor del punto de manera continua.

Me he perdido y ha acabado hablando de macacos.

\subsubsection{Enfoque formal de la orientación}

Formalmente, esto no es más que una orientación en cada plano tangente. En cada punto, consideramos una forma bilineal de dos vectores alternada, y eso es elegir una orientación y esa orientación cada plano tiene una base $∂_{x_1}, ∂_{x_2}$ y esto nosequé $ω_2$ una 2-forma en $X$ definida globalmente que nunca se anula porque entonces tendríamos sentido de giro nulo. Y esto es dar en cada punto una orientación del espacio tangente es elegir uno\footnote{sic} de los dos semirrectas que algo.

Otra definición posible de orientación es la siguiente:

\begin{defn}[Orientable] $X$ es orientable si y sólo si existe una $n$-forma $ω$ en $X$ tal que $ω_x ≠ 0\;∀x∈X$. \label{defOrientableForma}
\end{defn}

A la $n$-forma $ω$ se le llama la \concept[Forma\IS de volumen]{forma de volumen}, así que definiremos el \concept[Volumen]{volumen de una variedad}\footnote{Por supuesto, si tenemos una superficie será el área.} como \[ \mop{Vol(X)} ≝ \int_X ω\]

El volumen depende de la elección de la forma de volumen. La cuestión es que si asociamos a cada punto una métrica Riemanniana (un producto escalar, ver apuntes de GCS) tenemos un volumen riemanniano.

¿Qué ocurre cuando tenemos dos formas de volumen en un punto? Son dos $n$-formas que no se anulan nunca, luego se pueden dividir. Las diferenciales se cancelarán y quedará una función definida en la variedad. Y si las dos formas son de la misma orientación, la función es siempre positiva. Luego dos formas de volumen $ω_n, ω_n'$ difieren simplemente en la multiplicación por una función positiva. Esto lo que quiere decir es que en cada punto simplemente cambiamos la escala de medida en ese punto. La métrica nos permitirá escoger una base intrínseca ortonormal que nos da un cubo unidad, que es la forma de volumen intrínseca en una variedad riemanniana. Si no es una variedad riemannian a asdnasd no tenemos un volumen intrínseco y tenemos que cambiar de escala entre una y otra cosa y no sé qué más.

\subsubsection{Equivalencia de las definiciones de orientación}

Tenemos $X$ una variedad $n$-dimensional orientada con $(U_i, ρ_i)$ una partición de la unidad de $X$. Si queremos que sea orientable según la definición \ref{defOrientableForma}, buscamos una $n$-forma $ω$ que no se anula en ningún punto de la variedad.

Una $n$-forma que no se anula en una carta es $ω_i ≝ \dfl{x_1}{x_n}$ donde $x_1, \dotsc, x_n$ son las coordenadas de $U_i$. Así, podemos definir la $n$-forma globalmente como \[ ω ≝ \sum ρ_i ω_i \]

Tenemos que demostrar, eso sí, que $ω_x ≠ 0\; ∀x ∈ X$. El problema lo podríamos tener cuando $x$ está en varias cartas. Supongamos $x ∈ U_1$. Entonces, \[ ω_x = ρ_1 \dfl{x_1}{x_n} + ρ_2 J_2 \dfl{x_1}{x_n} + \dotsb \] donde $ρ_1 ≥ 0$ y $J_2$ es el jacobiano del cambio de carta de $U_1$ a $U_2$, que por ser $X$ orientable es positivo. Tenemos entonces que todos los coeficientes son positivos y por lo tanto $ω_x$ es no nulo.


En el otro sentido, tenemos una variedad $X$ $n$-dimensional y $ω$ una $n$-forma tal que $ω_x ≠ 0\; ∀x∈X$. Para un entorno $U$ de $x∈X$, sea $\appl{Ψ_x}{U}{ℝ^n}$ que es un difeomorfismo con su imagen. Entonces $(\inv{Ψ_x})^* ω = f \dfl{x_1}{x_n}$ con $f$ definida en un abierto de $ℝ^n$ y positiva.

Con el conjunto de todos los $Ψ_x$ podemos sacar un atlas para $X$, y queremos ver que el jacobiano del cambio es positivo siempre. Sean $Ψ_j, Ψ_i$ dos difeomorfismos que se intersecan. Tenemos entonces \begin{align*}
(\inv{Ψ_i})^* ω &= f \dfl{x_1}{x_n} \\
(\inv{Ψ_j})^* ω &= g \dfl{y_1}{y_n}
\end{align*} con $f,g > 0$.

Vamos a escribir entonces la diferencial $\dfl{y_1}{y_n}$ en función de las variables $x_1, \dotsc, x_n$. Nos quedará \[ g(y_1(x_1, \dotsc, x_n), \dotsc) \det \left(\dpd{y_i}{x_j}\right)_{i,j} \dfl{x_1}{x_n} \] que es igual a $f(x_1, \dotsc, x_n)\dfl{x_1}{x_n}$. Como por hipótesis $f,g > 0$ entonces el determinante ese tiene que ser positivo.

\section{Borde de una variedad}

\hfill \textit{Predigo que lo mejor que puedes hacer en este capítulo es mirar los apuntes de análisis matemático.}

Empezamos definiendo \[ H^n ≝ \set{(x_1, \dotsc, x_n) ∈ ℝ^n \tq x_1 ≤ 0} \] y su borde como \[ ∂H^n ≝ \set{(0, x_2, \dotsc, x_n) ∈ ℝ^n }\]

Por ejemplo, $H^2$ sería el lado izquierdo del plano (con $x$ negativo) y su borde sería el eje $x = 0$.

Sea $V ⊂ H^n$ un abierto y $\appl{f}{V}{ℝ}$ una función. Si $V$ no contiene ninguna parte del borde estamos en un abierto normal de $ℝ^n$, y entonces sabemos decir perfectamente qué quiere decir que $f$ sea diferenciable. Cuando sí tenga partes del borde, diremos que $f$ es diferenciable si se puede extender a una función diferenciable que, restringida a $V$, sea $f$. Esto es, si $V ∩ ∂H^n ≠ ∅$, diremos que $f$ es diferenciable si y sólo si existe un abierto $U ⊂ ℝ^n$ con $V⊂U$ y una función $\appl{\gor{f}}{U}{ℝ}$ tal que $\restr{\gor{f}}{V} = f$.

\begin{defn}[Variedad\IS con borde] Diremos que una variedad $X$ es una variedad con borde $n$-dimensional si $X = \bigcup U_i$ con las cartas definidas por homeomorfismos \[ \appl{Ψ_i}{U_i}{V_i ⊆ H^n} \]

Como observación, no es necesario que exista algún $V_i$ que contenga una parte del borde de $H^n$. Si ocurre esto, tenemos una variedad con borde vacío.
\end{defn}

Ahora podemos definir formalmente el borde:

\begin{defn}[Borde\IS de una variedad] Dada una variedad con borde $X$, su borde (denotado por $∂X$) se define como \[ ∂X ≝ \set{x ∈ X \tq ∃Ψ_i \; Ψ_i(x) ∈ ∂H} \]
\end{defn}

Tenemos que ver, eso sí, que el borde está bien definido y que no varía si cogemos otra carta.

\begin{prop} El borde de $X$ está bien definido y es independiente de la carta escogida. \end{prop}

\begin{proof} Sea $x ∈ X$ un punto en la intersección de dos cartas $U_i, U_j$. Vamos a demostrar la proposición por reducción al absurdo: supongamos que con $U_i$ está en el borde pero no con $U_j$. Sean $f_i, f_j$ las parametrizaciones respectivas, y sean $x_i = \inv{f_i}(x),\, x_j = \inv{f_j}$.

Como $x_j$ no está en el borde según la carta $U_j$, tenemos un entorno $V ⊂ H^n$ cuya intersección con el borde de $H^n$ es vacía, esto es, $V ∩ ∂H^n = ∅$.

Podemos construir el difeomorfismo $\inv{f_i}○f_j$ por ser un cambio de carta. $V$ tiene que tener una imagen en $U_i$ que sea un entorno de $x_i$. Ese entorno debería tener puntos fuera de $H^n$, una contradicción.
\end{proof}

\begin{prop} $∂X$ es una variedad $(n-1)$-dimensional y orientada. \end{prop}
\begin{proof} Demostrar que es una variedad es fácil porque nosequé.

Vamos ahora a demostrar la orientación. Supongamos que tenemos dos cartas $U_x, U_y$ con determinante del jacobiano del cambio de carta positivo y con coordenadas $x_1, \dotsc, x_n$ y $y_1, \dotsc, y_n$ respectivamente. En la primera carta, el borde estará dado cuando $x_1 = 0$ y en la segunda que $y_1 = 0$.

Estudiamos el determinante del jacobiano: \[ \left|\begin{matrix}
\dpd{y_1}{x_1} & \dpd{y_1}{x_2} & \dots & \dpd{y_1}{x_n} \\
\dpd{y_2}{x_1} & \dots & \dots & \dpd{y_2}{x_n} \\
\vdots &  \dots & \ddots & \vdots \\
\dpd{y_n}{x_1} & \dpd{y_n}{x_2} & \dots & \dpd{y_n}{x_n} \\
\end{matrix}\right| \]

Como $y_1 = 0$, tenemos que $\pd{y_1}{x_i} = 0$ para $i ≠ 1$. Por lo tanto, sólo nos interesa el subdeterminante ese. Y no sé por qué induce una orientación.
\end{proof}

\section{Teorema de Stokes}

\begin{theorem}[Teorema\IS de Stokes] \label{thmStokes} Sea $X$ una variedad $n$-dimensional compacta\footnote{Esto no es del todo importante. Es porque hemos demostrado la existencia de particiones de la unidad sólo en variedades compactas. Para variedades no compactas se hace con cubrimientos infinitos pero localmente finitos.}, orientable y con borde $∂X$; y $ω$ es una $(n-1)$-forma en $X$. Llamamos $i$ a la inmersión de $∂X$ en $X$ ($i:∂X \hookrightarrow X$). Entonces \[ \int_X \dif ω = \int_{∂X} i^* ω \]
\end{theorem}

\begin{proof} Suponemos que tenemos una partición $(U_i, ρ_i)$ de la unidad. Lo primero es que basta ver que la fórmula se cumpla en los abiertos de la partición de la unidad, gracias a la forma en la que se definen las integrales (\ref{defIntegracionNForma}).

Definimos $ω_j ≝ ρ_j ω$ de tal forma que $\sum ω_j = ω$. Entonces \( \dif ω = \dif \left(\sum_j ω_j\right) = \sum_j \dif(ρ_j(ω)) = \underbracket{\sum_j \dif ρ_j \y ω}_{(A)} + \sum_j  ρ_j \dif ω  = \sum_j ρ_j \dif ω \label{eqProofStokes1} \)

La observación que hay que hacer es que $(A)$ es nulo: podemos sacar factor común y entonces

\[ (A) = \left(\sum_j \dif ρ_j\right) \y ω = \left(\dif\left(\sum_j ρ_j \right) \right) \y ω = \dif 1 \y ω = 0\]

Ahora podemos calcular la integral: \( \int_X \dif ω = \sum_j \int_X ρ_j \dif ω \eqexpl{\ref{eqProofStokes1}} \sum_j \int_X ρ_j \dif ω \eqreason{Por Stokes en los abiertos.} \sum_j \int_{∂X} i^*(ρ_j ω) \eqreasonup{Por la definición de la integral.} \int_{∂X} i^* ω \label{eqProofStokesFinal} \)

Nos falta probar que Stokes es cierto en los abiertos, esa penúltima igualdad ahí.

Ahora va a hacer algo en un abierto coordenado $\mop{sop}ω ⊂ U_i$ que no corta al borde. Podemos tomar entonces un paralelepípedo que no corta al borde, al que llamamos $Q$. Como el soporte no corta al borde, la integral de $ω$ en el borde es nula.Ahora estoy usando $ω$ como una $n-1$ forma con soporte compacto contenido etcétera. Esta $ω$ no es la ω de antes. Es otra, sería como una $ρ_j ω$. Luego aplicaré esto al $ω$ de antes. Por no complicar la notación\footnote{Claro que sí.}.

Bueno, al lío. Tenemos que $\int_{∂X} i^* ω = 0$, para que Stokes sea cierto en este abierto tiene que ser \( \int_X \dif ω = 0 \label{eqProofStokesIntegAbierto} \). Para que las cosas sean más claras escribimos \[ ω = \sum a_i \dif x_1 \y \dotsb \y \dif \hat{x}_i \y \dotsb \dif x_n \], donde la $\hat{x}_i$ es la que no aparece en la carta coordenada\footnote{Juraría que esto tiene algo que ver con lo de los semiplanos.}. La diferencial será \[ \dif ω = \sum_j (-1)^{j-1} \dpd{a_j}{x_j} \dfl{x_1}{x_n} \]

Vamos ahora a calcular la integral de \eqref{eqProofStokesIntegAbierto}. Como el soporte de $ω$ está contenido en $Q$ cambiamos $X$ por $Q$ y entonces \[ \int_X \dif ω = \int_q \dif ω = \sum (-1)^{j-1} \int_Q \dpd{a_j}{x_j} \dfl{x_1}{x_n} \]

Integramos ahora primero en la coordenada $j$, usando la regla de Barrow\footnote{Qué manía de no llamarle Teorema Fundamental del Cálculo, que mola más.}. Entonces, usando Fubini nos queda la integral \( \sum (-1)^{j-1} \int \mathcal{N} \dif x_1 \y \dotsb \y \dif \hat{x}_i \y \dotsb \dif x_n \label{eqProofStokes2} \)

Por alguna razón que me he perdido, la $\mathcal{N}$ es la resta de dos cosas que son cero y luego te sale 0 al final.

Según De Juan, la razón que me he perdido es que como estamos integrando en $Q$ que es más grande que el soporte, los límites de la integral van a estar evaluados fuera del soporte de $ω$ y por lo tanto van a ser 0. A mí me parece convincente.

Edu ha dicho algo y De Juan me comenta que en la página 60 (56 según el libro) del doCarmo por alguna razón se quitan los diferenciales y se quedan productos normales. Gracias De Juan.

El caso que falta es ver lo que ocurre cuando el soporte sí interseca con el borde. La integral sobre el borde es fácil de calcular.

Calculamos rápidamente $i^*ω$. Estamos restringiendo a $x_1 = 0$, por lo tanto nos quitamos todos los sumandos de $ω$ que tienen $\dif x_1$ y nos queda \[ i^* ω = a_1(0, x_2, \dotsc, x_n) = \dfl{x_2}{x_n} \], por lo que la integral es  \[ \int_{∂X} i^*ω = \int_Q a_1(0, x_2, \dotsc, x_n) \dif x_2 \dotsb \dif x_n \]

El cálculo de la diferencial de $ω$ es el mismo, así que reutilizamos \eqref{eqProofStokes2}. Los sumandos con $j≠1$ se nos anulan por la misma razón que antes, así que nos queda sólo el sumando con $j=1$:  \[ \int_X \dif ω = \int_{Q^{n-1}} (a_1(0, x_2, \dotsc, x_n) - \underbrace{a_1(\dotsc)}_{(B) = 0}) \dif x_2\dotsb \dif x_n \], donde $(B)$ se anula porque será la evaluación de la integral en el otro lado de $Q$ que no interseca con el soporte de $ω$, y efectivamente nos queda lo que buscábamos: \[ \int_{∂X} i^*ω = \int_X \dif ω \]

Hemos demostrado entonces lo que nos faltaba de la ecuación \eqref{eqProofStokesFinal} y hemos demostrado por tanto el teorema entero.
\end{proof}

De los ejercicios que hay en el libro el profesor nos recomienda unos pocos, que son más fáciles. Del capítulo 4, los ejercicios 7,8,9 de la página 72; y el 16 también que refiere al 12 que ya lo hizo en teoría\footnote{Vete tú a saber dónde.}.

De los que están ahí\footnote{¿Dónde es ahí?}...\footnote{Esta frase no la ha acabado, no es que yo sea tonto.} Quizás mencionar que muchos de los ejercicios que piden usar Stokes piden relacionar la integral en una esfera maciza con la integral en el borde: es fácil porque sólo tiene una carta. El que quería enunciar dice lo siguiente:

\begin{problem} Consideramos $\bbs^3 ⊂ ℝ^4$, y el toro \[ T_2 = \set{(x,y,z,t) \tq x^2+y^2 = 1 \y x^2 + t^2 = 1}\] que está contenido en $\bbs^3$.

\ppart Demostrar que $\bbs^3 \setminus T_2$ es la unión disjunta de dos componentes conexas.
\ppart Sea $ω_3$ la 3-forma dada por \[ ω_3 = z \dif x \y \dif y \y \dif t - x \dif y \y \dif z \y \dif t \]

Calcular la integral de $i^*ω$ en cada una de las componentes conexas calculadas en el apartado anterior.

Esto se puede hacer usando Stokes y sin ello. Se pide hacerlo de las dos maneras.
\solution
\end{problem}
