\chapter{Ejercicios}
\section{Hoja 1}
\begin{problem}[11]
	 Averigua la llave utilizada en un metodo afın cuando tenemos que el
	 texto original es “3241” y el texto cifrado es “1203” en $Z_6$.
	\solution
	Para solucionarlo tenemos que resolver el sistema de ecuaciones:
	$$\begin{cases}
		1= 3\cdot a + b \text{ mod 6}\\
		2 = 2 \cdot a +b \text{ mod 6}\\
		0 = 4 \cdot a +b \text{ mod 6}\\
		3 = 1 \cdot a+b \text{ mod 6}\\
	\end{cases}$$
	
	$$a=5$$
	$$b=4$$
\end{problem}


\begin{problem}[24]
	Calcula $\phi(m)$ cuando $m = p · q$ donde p y q son primos. Demuestra que
	si $m = p · q$ donde p y q son primos, entonces $\phi(m) = \phi(p)\phi(q)$
	\solution
	
	Recordamos que $\phi(m) = \Pi_{i=1}^n (P_i^{e_i} - P_i^{e_{i-1}})$, siendo $P_i$ los primos en los que se descompone m y $e_i$ su multiplicidad.
	
	Además $\phi(m)$ es el número de coprimos de m menores que m.
	
	Entonces
	$$\phi(m) = \Pi_{i=1}^n (\pi^{e_i} - \pi^{e_{i-1}}) = (p-p^{1-1})\cdot(q-q^{1-1}) = (p-1)(q-1) = \phi(p)\cdot \phi(q)$$
\end{problem}

\begin{problem}[19]
	
	Demuestra que el $mcd(a, b) = mcd(b, a mod b)$, para $a > b$.
	
	\solution
	
	Vemos que a mod b es el resto de dividir a entre b.
	$$r = a-q\cdot b \implies \textbf{Si }\begin{cases}
	 d|a\\
	 d| b\\
	\end{cases} \implies d|(a-b\cdot q) = r \implies d|r$$
	Y como esto se cumple con todos los divisores de a y de b, también se cuple para el mcd
\end{problem}


\begin{problem}[10a]
	\solution
	Para resolverlo necesito calcular el inverso multiplicativo de 3 mod 7.
	
	Hago Euclides
	
	$$7 = 3 \cdot 2 +1$$
	$$3 = 1\cdot 3 +0$$
	$$1 = 7-3 \cdot 2 = 7 + 3 \cdot (-2)$$
	
	Entonces el inverso multiplicativo es $-2$ que es igual a 5.
	
	Entonces
	$$x \equiv 5 \cdot 4 \text{ mod 7} = 6$$
\end{problem}


\begin{problem}[14]
	¿es esto un criptosistema?
	\solution
	$$K = \left(\begin{matrix} 
	10 & 5 & 12\\
	3 & 14 & 21 \\
	8 & 9 & 11
	\end{matrix}\right)$$
	
	$$det(K) = 7$$
	
	Primero tenemos que ver que el determinante es coprimo con 26.
	
	$$26 = 3 \cdot 7 +5$$
	$$7 = 5\cdot 1 +2$$
	$$5 = 2\cdot 2 + 1$$
	$$2 = 2 \cdot 1 +0$$
	
	Por lo tanto si que es cierto que $mcd(26,7) = 1$
	
	Con esto ya sabemos que es criptosistema pero además vamos a calcular el inverso de 7.
	
	$$1 = 5 - 2 \cdot 2 = 5 - 2 \cdot(7-5) = 3 \cdot 5 - 2 \cdot 7 = -2 \cdot 7 + 3 \cdot(26 - 3\cdot 7) = -11\cdot 7 +3 \cdot 26$$
	
	Como $3 \cdot 26$ es 0 mod 26 nos queda
	$$1 = -11\cdot 7 \text{ mod 26}$$
	
	Por tanto el inverso es -11 mod 26 = 15 mod 26.
	
	Y ahora ya podemos calcular $K^{-1}$
	
	$$K ^{-1} = \left( \begin{matrix}
	21 & 15 & 17\\
	23 & 2 & 16\\
	25 & 4 & 3
	\end{matrix}\right)$$
	
\end{problem}

\section{Hoja 2}
\begin{problem}[9]
		$$P=C = (Z_{26})^2$$
		$$a \in (Z_m \times Z_m)^*$$
		$$b \in (Z_m \times Z_m)$$
		$$|P| = |C| = |Z_m|^2$$
		¿distancia de unicidad?
	\solution
	Vemos que $|P| = m^2$ y $|K| = |a| \times |b| = \phi(m^2) \times m^2$
	
	$$n_0 \simeq \frac{log_2 |K|}{R_L \cdot log_2|P|} = \frac{log_2(m^2 \cdot \phi(m^2))}{R_L \cdot log_2(m^2)} = \frac{1}{R_L}\frac{log_2 m^2 + log_2 \phi(m^2)}{log_2 (m^2)} = \frac{1}{R_L}(1 + \frac{log \phi(m^2)}{log_2(m^2)})$$
	
	Como $m^2 > \phi(m^2) \leq 0$ entonces $0 < \frac{log_2\phi(m^2)}{log(m^2)}<1$. Por lo tanto:
	$$\frac{1}{R_L} < n_0 < \frac{2}{R_L}$$
\end{problem}


\begin{problem}
	Tenemos las variables x,y,z tal que 
	$$A_x = A_y = A_z = \{0,1\}$$
	$$P_x = \{p, 1-p\}$$
	$$P_y = \{q, 1-q\}$$
	x e y son independientes
	$$z = x+y \text{ mod 2}$$
	Para un p y un q dados, cual es el valor de $P_z$?
	\solution
	Escribimos la probabilidad de z como:
	$$P_z = \sum_{xy} P(x,y,z) = \sum_{xy} P(z|xy)\cdot P(xy)$$
	Como x e y son independientes: $P(xy) = P(x)\cdot P(y)$
	$$P_z = \sum_{xy} P(z|xy)\cdot P(x)\cdot P(y)$$
	
	Vamos a escribir la tabla de valores
	\begin{center}
		
	
	\begin{tabular}{l | c | r}
	z & x & y\\
	\hline
	0 & 0 & 0\\
	1 & 0 & 1\\
	1 & 1 & 0\\
	0 & 1 & 1
	\end{tabular}
	
\end{center}

$$P(z = 0 | x= 0 , y = 0) = 1$$
$$P(1|1 0) = 1$$
$$P(1|10) = 1$$
$$P(0 |11) = 1$$

$$P_z(z=0) = P_z(0|00)P_x(0)P_y(0) + P_z(0|11)P_x(1)P_y(1) = p\cdot q + (1-p)(1-q)$$

$$P_z(z=1) = P_z(1|01)P_x(0)P_y(1) + P_z(1|10)P_x(1)P_y(0) = p\cdot (1-q) + (1-p)\cdot q$$

El apartado b es igual ya que en $Z_2$ la resta es igual que la suma.
\end{problem}

\begin{problem}[13]
	$$ P = \{0,1,2\}$$
	$$ K = \{ 01, 02 , 11 , 12 , 21 , 22 \}$$
	$$C = \{0,1,2\}$$
	$$P_K(K) = \frac{1}{6}$$
	\begin{center}
		\begin{tabular}{l | c c r}
			 K & P=0 & P=1 & P= 2\\
			 \hline
			 01 & 0 & 1 & 2\\
			 02 & 0 & 2 & 1\\
			 11 & 1 & 2 & 0\\
			 12 & 1 & 0 & 2\\
			 21 & 2 & 0 & 1\\
			 22 & 2 & 1 & 0
		\end{tabular}
	\end{center}
	\solution
	Vemos que si que es un criptosistema porque 
	
	Ahora vamos a ver si cumple la seguridad perfecta, es decir, si cumple:
	$$P_p(x) = P_p(x|y)$$
	
	Utilizamos Bayes:
	
	$$P_p(x|y) = \frac{P_p(x) \cdot P_c(y|x)}{P_c(y)}$$
	$$P_c(y|x) = \sum_{K|y 0 e_k(x)}P_K(K)$$
	$$P_c(y) = \sum_{\forall x, K|y = e_K(x)} P_p(x) \cdot P_K(K)$$
	
	Empezamos calculando $P(y|x)$:
	
	$$P(y=0|x=0) = P_K(01) + P_K(02) = \frac{1}{6} + \frac{1}{6} = \frac{1}{3}$$
	
	$$P(y=0|x=1) = P_K(12) + P_K(21) = \frac{1}{6} + \frac{1}{6} = \frac{1}{3}$$
	
	$$P(y=0|x=2) = P_K(02) + P_K(22) = \frac{1}{6} + \frac{1}{6} = \frac{1}{3}$$
	
	Y seguiriamos con todos los demás posibles valores (y=1, y=2), y vemos que todos dan $\frac{1}{3}$
	
	Vamos a calcular ahora $P_c(y)$
	
	$$P(y=0) = P_P(0)\cdot P_K(01) + P_P(0)\cdot P_K(02) +$$ $$ +P_P(1)\cdot P_K(12) + P_P(1)\cdot P_K(21) +$$ $$+ P_P(2)\cdot P_K(11) + P_P(2)\cdot P_K(22) $$
	
	Como todas las $P_K()$ valen $\frac{1}{6}$ sacamos factor común y nos queda:
	$$P(y=0) = \frac{1}{6}\cdot (P_P(0) + P_P(0) + P_P(1) + P_P(1) + P_P(2) + P_P(2) =$$ $$=\frac{2}{6}\cdot(P_P(0) + P_P(1) + P_P(2)) = \frac{1}{3}$$
	
	Y pasa lo mismo con $P(y=1)$ y $P(y=2)$
	
	Entonces ya podemos aplicar Bayes
	
	$$P_P(x|y=0) = \frac{P_P(x) \cdot \frac{1}{3}}{\frac{1}{3}} = P_P(x)$$
	
	$$P_P(x|y=1) = \frac{P_P(x) \cdot \frac{1}{3}}{\frac{1}{3}} = P_P(x)$$
	
	$$P_P(x|y=2) = \frac{P_P(x) \cdot \frac{1}{3}}{\frac{1}{3}} = P_P(x)$$
	
	SI TENEMOS SEGURIDAD PERFECTA
	
\end{problem}
\section{Hoja 3}