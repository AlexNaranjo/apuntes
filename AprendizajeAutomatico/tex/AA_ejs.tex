% -*- root: ../AprendizajeAutomatico.tex -*-

\section{Hoja 1}

\begin{problem}[1]

Un taxi golpea a una persona de noche y huye. En la ciudad operan dos compañías de taxis. Una verde y otra azul. El 85\% de los taxis son verdes. 

\ppart
¿De qué color es más probable que sea el taxi?

\ppart
Un testigo dice que es azul con fiabilidad del 80\%

\ppart Decisión final usando el criterio de máxima verosimilitud y el criterio de máxima probabilidad a posteriori.

\solution
\paragraph{Notación} H de hipótesis, D de Datos e I de información.

\spart
Se deja como ejercicio para el lector experimentado.

\spart
P(H=verde) = 85\%
P(H=azul) = 15\%

\[
P\left( H=azul | D=azul, I \right) = \frac{P(D=a|H=a,I)·P(H=A|I)}{P(D=a|I)}
\]

Para calcularlo, necesitamos saber la probabilidad con la que el testigo dice que un taxi es azul.\footnote{Suponemos que el testigo se equivoca igual de azul a verde que de verde a azul}
\[
P(D=a|I) = P(D=a|H=a)·P(H=a) + P(D=verde | H=v) · P(H=v) = 0.8·0.15 + 0.2·0.85 = 0.29
\]

Con esto ya tenemos:

\[
 P\left( H=azul | D=azul, I \right) = \frac{0.8·0.15}{0.29} = 0.41
\]

Por el contrario, la probabilidad de que el taxi sea verde (utilizando la información del testigo) es de un 0.59.

\paragraph{Notación} Observamos que todas las probabilidades son condicionadas a I, que no influye en nada y omitiremos cuando no sea influyente

\spart Por el criterio MV - máxima verosimilitud (\ref{CriterioMV}):

\[ \max_i  \{P(D=a|H=a),P(D=a|H=verde)\} = \max_i \{0.8,0.2\} = P(D=a|H=a)\]

Este criterio, al ser más sencillo y omitir parte de la información (que a veces no podremos calcular), nos da una respuesta menos correcta, y en este caso contraria a la obtenida anteriormente. 

\end{problem}

\begin{problem}[2]
Las probabilidades pueden representar conexiones lógicas, no casuales. Consideremos una urna con 6 bolas blancas y 6 bolas negras

\ppart En la primera extracción se ha eliminado una bola blanca. ¿Cuál es la probabilidad de extraer una bola blanca en la segunda extracción?

\ppart Por el contrario, supongamos que la segunda extracción ha sido blanca. ¿Cuál es la probabilidad de que la primera fuera blanca también?

\solution

\spart $P(s=b|p=b) = \frac{5}{11}$

\spart Como siempre, empezamos definiendo los datos y las hipótesis.

$D\equiv (s=b)$ donde $s$ se refiere a segunda extracción.

$H\equiv (p=b|p=n)$ donde $p$ se refiere a primera extracción.

\[P(p=b|s=b) = \frac{P(s=b|p=b)·P(p=b)}{P(s=b)} = \frac{\frac{5}{11}·\frac{6}{11}}{P(s=b)}\]

Donde $P(s=b) = \frac{6}{12}·\frac{5}{12}+\frac{6}{12}\frac{6}{12}$, con lo que 
\[P(p=b|s=b) = \frac{5}{11}\]

\[P(p=n|s=b) = \frac{P(s=b|p=n)·P(p=n)}{P(s=b)} = ... = \frac{6}{11} \]

Por si el lector avispado se lo pregunta, $P(p=n|s=b) + P(p=b|s=b) = 1$ no es casualidad. Sólo hay 2 opciones, o la primera era negra o era blanca, independientemente de toda la información de la que dispongamos. 

\end{problem}

\begin{problem}[3]

Según el hombre del tiempo, la probabilidad de lluvia hoy es del  20\%. Estamos en un sótano siun ventanas y no podemos saber qué tiempo hace fuera. Sin embargo, vemos entrar a alguien llevando un paraguas. Sabiendo que la probabilidad de que alguien lleve paraguas y esté lloviendo es del 70\% y sólo del 10\% en caso contrario. ¿Cuál es la probabilidad de que esté lloviendo?

\solution 

Aclaramos  que la probabilidad del 10\% se refiere a llevar paraguas en caso de que no esté lloviendo.


$D = p$, es decir, alguién entra con paraguas.

$H = r$ (rain), es decir, llueve.

\[P(r|p) = \frac{P(p|r)·P(r)}{P(p)} = \frac{0.7·0.2}{P(p)} \]
\[P(\bar{r}|p) = \frac{P(p|\bar{r})·P(\bar{r})}{P(p)} = \frac{0.1·0.8}{P(p)} \]

Para saber cuál es más probable, no es necesario calcular el denominador. Por ello concluiomos que es más probable que esté lloviendo (ya que $0.14 > 0.08$).



Para calcular las probabilidades con exactitud, necesitamos saber $P(p)$. Para ello tenemos 2 opciones:

La versión corta, es que $P(r|p) + P(\bar{r}|p) = 1$, con lo que el denominador debe ser $P(p) = 0.7·0.2 + 0.1·0.8$, con lo que las probabilidades son $63.8\%$ y $36.2\%$ respectivamente.

Por otro lado, podríamos aplicar la regla del producto para calcularlo:
\[
P(p) = P(p|r)·P(r) + P(p|\neg r)·P(\neg r) = 0.7·0.2 + 0.1·0.8  
\]

Obteniendo exactamente el mismo resultado.


\end{problem}

\begin{problem}[4]
Tenemos 2 bolsas. La bolsa A tiene 2 bolas negras y 3 blancas. La bolsa B tiene 3 bolas negras y 2 blancas.

\ppart Se elige una de las bolsas al azar, y escogemos al azar una bola. ¿Cuál es la probabilidad de que sea negra?

\ppart Habiendo extraido una bola negra. ¿Cuál es la bolsa más probable?

\ppart Decisión final usando el criterio de máxima verosimiitud y el critero de máxima probabilidad a posteriori.

\solution

\spart 
\[
P(negra) = P(A,negra) + P(B,negra) = P(negra|A,I)·P(A) + P(negra|B,I)·P(B)\]
\[
P(negra) = 0.4*0.5+0.6*0.5 = 0.5
\]
\spart La intuición nos dice que será de la bolsa B, ya que esta tiene más bolas negras, y las 2 bolsas son equiprobables.

Vamos a justificarlo matemáticamente:

P(H=A) = 50\%

D=negra

\[
P(A|D=negra) = \frac{P(negra|A)·P(A)}{P(negra)}
\]




\end{problem}

\begin{problem}[5]
Hay 2 bolsas: A y B. La bolsa A contiene 2 bolas negras y 3 blancas. La B, 3 negras y 2 blancas. Se selecciona una bolsa al azar, teniendo en cuenta que la bolsa A tiene un 75\% de probabilidad de ser elegida, y se extrae una bola.

\ppart Calcular la probabilidad de que la bola sea negra.

\ppart Si la bola obtenida ha sido negra, calcular qué bolsa es más probable que hayamos elegido.

\ppart Decisión final usando el criterio de máxima verosimilitud y el criterio de máxima probabilidad a posteriori.


\solution
\paragraph{Notación:\\} 
$n,b$ se refiere a bola negra o blanca respectivamente.

$A,B$ se refieren a la bolsa de la que se ha extraído la bola.

\spart $P(n) = P(n | A)·P(A) + P(n|B)·P(B) = \frac{2}{5}·\frac{3}{4} + \frac{3}{5} · \frac{1}{4} = \frac{9}{20}$

\spart $P(A|n) = \frac{P(n|A)·P(A)}{P(n)} = \frac{\frac{2}{5}·\frac{3}{4}}{\frac{9}{20}} = \frac{2}{3}$

Por otro lado, $P(B|n) = \frac{1}{3}$. Como la bola sólo puede estar en la bolsa A o en la bolsa B, es decir, son casos disjuntos, $P(A|n) + P(B|n) = 1$. Si la bola pudiera estar en 2 bolsas a la vez, tendríamos que hacer el cálculo porque esta regla no se cumpliría.

\spart

Según el criterio MV - máxima verosimilitud (\ref{CriterioMV}), es más probable que la bolsa sea la B.

\[
\max_i\{P(n|A),P(n|B)\} = \max_i\{0.4,0.6\}\implies P(n|B)
\]

\end{problem}


\setcounter{section}{2}
\section{Tema 3}

\begin{problem}[1]

¿Cuál es la verosimilitud de $B,C,D,E$ dado $A$, siendo este el modelo gráfico?

5 nodos:
\begin{itemize}
	\item $A \to \{B,C,D\}$
	\item $B \to \{\} $
	\item $C \to \{B\} $
	\item $D \to \{E\} $
	\item $E \to \{C\} $
\end{itemize}

%\includegraphics[scale=0.8]{grafico31.png}


\solution

\[
P(A,B,C,D,E) = \underbrace{P(B|A,C) P(C|A,E) P (D|A)P(E|D)}_{\text{verosimilitud}}\underbrace{P(A)}_{\text{a priori}}
\]

\end{problem}

\begin{problem}
¿Cuál es el modelo gráfico asociado a ...?
\[P(x_1)P(x_2)P(x_3)P(x_4|X_1x_2x_3) P(x_5|x_1x_3) P(x_6 | x_4) P (x_7 | x_5x_4)\]

\solution

Un grafo con 7 nodos en el que:

\begin{itemize}
	\item $x_1 \to \{x_4,x_5\}$
	\item $x_2 \to \{x_4\}$
	\item $x_3 \to \{x_4,x_5\}$
	\item $x_4 \to \{x_6,x_7\}$
	\item $x_5 \to \{x_7\}$
	\item $x_6 \to \{ \}$
	\item $x_7 \to \{ \}$
\end{itemize}

\end{problem}


\begin{problem}

\begin{itemize}
	\item $Clase \to \{A,C,E\}$
	\item $A \to \{\}$
	\item $C \to \{A\}$
	\item $E \to \{\}$
\end{itemize}

Además, tenemos:

\begin{center}
\begin{tabular}{ccc|c}
A&C&E&Clase\\
\hline
1&1&0&A \\
1&0&1&A \\
0&0&0&S \\
0&1&1&S \\
0&1&1&A \\
1&1&0&A \\
1&1&0&A \\
0&0&1&S \\
1&0&1&A \\
1&0&0&S \\
\end{tabular}
\end{center}

\solution


\[P(\text{Clase}=A | A=1,C=0, E=0) = \]
\[\frac{P(A=1|C=1,\text{Clase} = A) P(C=0|\text{Clase} = A) P (E=0 | \text{Clase} = A) P (\text{Clase}= A)}{P(A=1,C=0,E=0)}\]
$$P(\text{Clase}=A | A=1,C=0, E=0) = \frac{\left(\frac{2}{2}·\frac{2}{6}·\frac{3}{6}\right)\left(\frac{6}{10}\right)}{P(...)}$$

\end{problem}