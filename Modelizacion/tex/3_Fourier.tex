
\chapter{Aplicaciones del análisis de Fourier}
\section{Desarrollo de Fourier}
\textbf{Idea del análisis de Fourier:} "toda" señal se puede descomponer en "tonos puros" (armónicos) de frecuencia fija (típicamente $\sin(\alpha n x)$ , $\cos(\alpha n x)$  $ n \in \ent$).

Dibujo con caption ($\frac{1}{4} - \frac{2}{\pi^2} \sum_{n impares} \frac{1}{n^2} \cos(2\pi n x)$)

\begin{example}
	Cogemos $x=0$:
	$$0 = \frac{1}{4} - \frac{2}{\pi^2} \sum_{\text{n impares}} \frac{1}{n^2}$$ 
	$$1 + \frac{1}{3^2} + \frac{1}{5^2} + \ldots = \frac{\pi^2}{8}$$
\end{example}

\subsection{Aplicaciones}
\begin{itemize}
	\item Muchas aplicaciones de ingeniería están basadas en estas ideas. (JPEG,(MP3) MPEG, telecomunicaciones)
	
	Hay tonos puros (frecuencias) que se eliminan o modifican porque n tienen mucha influencia o son ruido.
	
	Menos frecuencia $\rightarrow$ Menos información $\rightarrow$ Compresión (pérdidas)
	
	En ingeniería una aplicación muy común es utilizar esto como filtro, en el caso del MP3 se eliminan las frecuencias que no oimos.
	
	\item En matemáticas y física: Hay problemas difíciles para funciones generales y fáciles para "tonos puros" (senos y cosenos).
	
		\textbf{Interpretación de Copenhague} : Las partículas tienen funciones de ondas y en los experimentos solo se detectan los tonos puros que componen estas funciones con una probabilidad que depende de su amplitud.
		
	Vamos a ver aplicaciones de esto:
	
	\textbf{\textit{Pasar de analógico a digital}}
	
	Vamos a hacer análisis de Fourier discreto con ondas digitalizadas.
	
	\begin{example}
		Vamos a estudiar la función $\sin(\frac{2\pi}{T}\cdot x)$
		
		Dibujo
		
		que es un caso particular de $\sin(\frac{2\pi}{T}\cdot k x)$ (oscila k veces en [0,T]).
		
		Dibujo
		
		Si digitalizamos la función, hacemos que x solo tenga valores discretos: $\sin(\frac{2\pi}{T}\cdot n)$
		
		Dibujo
		
		LLamamos $f(n)$ a la función discretizada, $n \in \ent$ ; Con N periódica $f(n + N) = f(n)$
		
		Matemáticamente pensamos $f(n)$ como :
		$$f : \ent/N\ent \rightarrow \mathbb{C} $$
	\end{example} 
	\obs Hemos puesto que f va a $\mathbb{C}$ porque $e^{ix} = \cos x * i\sin x$ permite escribir senos y cosenos al mismo tiempo.
	
	$$\cos x = \frac{e^{ix} + e^{-ix}}{2}$$
	$$\sin x = \frac{e^{ix} - e^{-ix}}{2i}$$
	
\end{itemize}

\begin{prop}[Análisis de Fourier en $\ent/N\ent$]
	
	Cualquier $f : \ent/N\ent \rightarrow \mathbb{C}$ se puede escribir como :
	$$f(n) = \frac{1}{N}\sum_{m\in \ent/N\ent}\widehat{f}(m)\cdot e(\frac{nm}{N})$$
	donde $e(x) = e^{2\pi ix}$
	
	$\widehat{f}(n)$ es la \textbf{transformada de Fourier discreta}
	$$\widehat{f}(n) = \sum_{m\in \ent/N\ent}\widehat{f}(m)\cdot e(\frac{-nm}{N})$$
	
\end{prop}
\obs Hay un algoritmo (FFT) para calcular los $\widehat{f}(m)$

\begin{proof}
	Definimos la función $\delta : \ent/N\ent \rightarrow \mathbb{C}$ como :
	$$\delta (n) = \begin{cases}
	1 \rightarrow n=0\\
	0 \rightarrow n\neq 0 \\
	\end{cases}$$
	Y decimos que también se puede escribir como:
	$$\delta (n) = \frac{1}{N} \sum_{m_0}^{N-1} e(\frac{nm}{N})$$
	Donde $e(\frac{nm}{N}) = e^{2\pi inm/N}$
	
	Es claro que $\delta(0) = 1$ , pero ¿se cumple que si $n\neq 0 \implies \delta (n) = 0$?
	
	Si se cumple, porque si lo pensamos como una progresión geométrica:
	$\begin{cases}
	a_1 = e(n0/N)\\
	a_{m+1} = e(nN/N)\\
	\text{razón } = \frac{1}{N}
	\end{cases}$
	
	Entonces:
	$$\delta (n) = \frac{e(nN/N) - e(0n/N)}{1/N - 1} = 0$$
	
	Otra forma de pensarlo es como vectores. $\delta(n)$ se puede ver como sumar todas las raíces de la unidad.Sumando todas las fuerzas vemos que se anulan.
	
	(dibujo explicativo para N=4)
	
	Una vez que tenemos esto, vemos que la $f(n)$ de la proposición se puede escribir como:
	$$f(n) = \sum_{k\in \ent/N\ent} f(k) \cdot \delta(n-k)$$
	Sustituyendo:
	$$f(n) = \frac{1}{N} \sum_{k\in \ent/N\ent} f(k)  \sum_{m \in \ent/N\ent} e(\frac{nm}{N}) \cdot e(- \frac{km}{N})$$
	
	Y como por definición:
	$$\widehat{f}(m) = \sum_{k\in \ent/N\ent} f(k) \cdot e(- \frac{km}{N})$$
	
	Pues ya está probada la proposición.
\end{proof}
\begin{example}
	Un ejemplo de esto con N=3
	
	DIBUJO
	
	Vemos que la función se va repitiendo po lo que cojo solo el tramo de 0 a 2 para estudiarla.
	$$f(n) = \begin{cases}
	7 si n= 0\\
	2 si n = 1 , 2
	\end{cases}$$
	
	Entonces aplicando la proposición nos queda:
	$$\widehat{f}(0) = f(0)\cdot e(0) + f(1)\cdot e(0) + f(2) \cdot e(0) =  11$$
	$$\widehat{f}(1) = f(0)\cdot e(0) + f(1)\cdot e(-\frac{1}{3}) + f(2)\cdot e(-\frac{2}{3}) = 7 + 2\cdot(-\frac{1}{2} -i\frac{\sqrt{3}}{2}) + 2\cdot (-\frac{1}{2} + \frac{i\sqrt{3}}{2}) = 5$$
	$$\widehat{f}(2) = f(0)\cdot e(0) + f(1)\cdot e(- \frac{2}{3} + f(2)\cdot e(-\frac{4}{3}) = 7 + 2\cdot(-\frac{1}{2} -i\frac{\sqrt{3}}{2}) + 2\cdot (-\frac{1}{2} + \frac{i\sqrt{3}}{2}) = 5$$
	Como 
	$$f(n) = \frac{1}{N} \sum_{m\in \ent/ N\ent} \widehat{f}(m) \cdot e(\frac{nm}{N})$$
	Sustituyendo con los resultados de antes nos queda que:
	$$f(n) = \frac{11}{3}\cdot e(0 \frac{n}{3}) + \frac{5}{3}\cdot e(1 \frac{n}{3}) + \frac{5}{3} \cdot e(2 \frac{n}{3})$$
	
	Y efectivamante, si comparamos resultados nos queda :
	$$n = 0 \rightarrow 7 = \frac{11}{3} + \frac{5}{3} + \frac{5}{3}$$
	$$n = 1 \rightarrow 2 = \frac{11}{3} + \frac{5}{3} \cdot (- \frac{1}{2} + \frac{i \sqrt{3}}{2}) + \frac{5}{3} \cdot (- \frac{1}{2} -\frac{i \sqrt{3}}{2})$$
\end{example}

Esta proposición se puede utilizar para \textbf{transformar funciones discretas(con N grande) a funciones continuas}.

DIBUJOS DE LA F DISCRETA Y CONTINUA

Tenemos f(n) discreta, llamamos $F(\frac{n}{N}) = f(n)$ a la función continua que queremos construir.


Haciendo el desarrollo de Fourier de f nos queda que:
$$f(n) = \sum \frac{\widehat{f}(m)}{N} \cdot e(\frac{nm}{N})$$

Llamamos $x = \frac{n}{N}$ y $a_m= \frac{\widehat{f}(m)}{N}$ y nos queda que :
$$F(x) = \sum_{n\in \ent } a_m \cdot e(mx)$$

Para calcular $F(x)$ necesitamos calcular primero el $a_m$. Para ello hacemos el límite de $\frac{\widehat{f}(m)}{N}$

Entonces tenemos que:
$$\frac{\widehat{f}(m)}{N} = \frac{1}{N} \sum_{k \in \ent/N\ent} f(k) \cdot e(-m \frac{k}{N}) \rightarrow \begin{cases}
	m \text{ fijo}\\
	N \text{ muy grande}\\
	f(k) = F(\frac{k}{N})\\
\end{cases}$$

Como $ k = 0 , \ldots , N-1 \implies 0\leq \frac{k}{N} < 1$ podemos tomar el sumatorio como suma de Riemann.

$$\frac{\widehat{f}(m)}{N} = \int_{0}^{1} F(x) \cdot e(-mx) dx$$

Entonces
$$F(x) = \sum_{m= -\infty}^{\infty} \widehat{F}(n) \cdot e(nx)$$
Siendo $\widehat{F}(n) = \int_{0}^{1} F(x) \cdot e(-nx) dx$

Y si F es buena ( p.ej $C^2$) entonces todo funciona bien.
Si no es buena hay casos donde no fuciona.
% % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % PARTE DE GUILLE % % % % % %
% % % % % % % % % % % % % % % % % % % % % % 

¿Porqué ocurre que la función que da el diente de sierra es? : $\frac{1}{2} - \frac{1}{\pi} \sum_{n=1}^{\infty} \frac{\sin(2\pi nx)}{n}$
	
Esta suma se puede probar que converge(pero la demostración no es fácil en absoluto) pero, excepto para $x = \frac{k}{2}$, se puede probar que la convergencia no es absoluta.

\begin{itemize}
	\item \textbf{Convergencia lenta:} es malo para las aplicaciones porque no podemos despreciar muchos coeficientes de Fourier.
	
	Si tengo una función $f: \ent_N \rightarrow \mathbb{C}$
	$$f(n) = \frac{1}{N}\sum_{m \in \ent_N}\widehat{f}(m)e(\frac{mn}{N})$$
	
	Para N grande y coeficientes parecidos $\implies$ es difícil decidir cuáles omitir.
	
	Vamos a suponer que tenemos una función 1-periódica $f : \Pi \rightarrow \mathbb{C}$ tal que $f \in C^{\infty}(\mathbb{R})$.
	
	Para $n \neq 0$
	
	$$\widehat{f}(n) = \int_{0}^{1} f(x) e(-nx) dx$$
	
	Llamamos $\begin{cases}
	u = f(x)\\
	dv = e(-nx) dx
	\end{cases}$
	
	Entonces:
	$$\widehat{f}(n) = f(x) \frac{e(-nx)}{-2\pi in}|_{0}^1 + \frac{1}{2\pi i n} \int_{0}^1 f'(x) e(-nx) dx$$
	
	Como $f(x) \frac{e(-nx)}{-2\pi in}|_{0}^1 $ es 0,como f es periódica, si seguimos iterando hasta k veces:
	
	$$\widehat{f}(n)  \frac{1}{(2\pi i n)^k} \int_{0}^1 f^{(k)}(x) e(-nx) dx$$
	
	y como $|f^{(k)}| \leq cte$ en [0,1] $\implies |\widehat{f}(n)| \leq \frac{cte}{|n|^k}$
	
	Con menos regularidad: $f^{(k)}$ existe excepto en un número finito de puntos (de [0,1]) y está acotada, daría el mismo resultado.
	
	Vamos a ver esto para $k=2$:
	
	$$k=2 \implies |\widehat{f}(n)| \leq cte \implies \sum_{n= -\infty}^{e(nx)}$$
	Converge absolutamente.
	
	
	% %DIBUJO RARUNO % %
	La extensión 1-periódica de una función, típicamente no es nisiquiera continua. $\implies$ típicamente no se puede tomar $k=2$ $\implies$ malo para las aplicaciones.
	
	En estos casos se usa un truco, en lugar de la extensión periódica primero se refleja la función(la señal) por el eje Y.
	
	Y después se extiende de forma 2-periódica
	
	Como el reflejo y la señal original coinciden en el final de una y el principio de la otra esta extensión si sería continua
	
	% Dibujo de la extensi´on%
	
	Entonces vamos a ver las ecuaciones de Fourier para las funciones 2-periódicas.
	
	$$f(x) = \sum_{n=-\infty}^{\infty} \widehat{f}(n)e(n\frac{x}{2})$$
	
	Siendo
	$$\widehat{f}(n) = \frac{1}{2} \int_{0}^{2} f(x) e(-nx)$$
	
	Estos números son reales si f es real.
	
	$$\widehat{f}(n) = \frac{1}{2} \int_{-1}^{1} f(x) e(-n\frac{x}{2}) dx = \frac{1}{2} \int_{-1}^{1} f(x)\cos(2\pi n \frac{x}{2})dx \in \mathbb{R}$$
	
	Eto es porque $e(-n\frac{x}{2}) = \cos(2\pi n \frac{x}{2}) + i \sin(2\pi n \frac{x}{2})$ y además f es par y $\sin$ es impar.
	
	¿Cómo adaptar esto al caso discreto $f: \ent_N \rightarrow \mathbb{C}$?
	
	% Dibujo discreto%
	
	Haciendo las cuentas se btiene un análisis de Fourirer discreto en el que podemos usar $e((m + \frac{1}{2}) \frac{n}{2N})$ en vez de $e(\frac{mn}{N})$ y tomando partes reales se puede escribir todo en términos $\cos(\frac{\pi n}{N}(m+ \frac{1}{2}))$
	
	\begin{prop}
		Para $f : \{0,1,2....,N-1\} \rightarrow \mathbb{R}$ se cumple
		$$f(m) = \frac{\widehat{f}^c(0)}{N} + \frac{2}{N} \sum_{n=1}^{N-1} \widehat{f}^c(n) \cos(\frac{n\pi}{N}(m + \frac{1}{2}))$$
		donde
		$$\widehat{f}^c(n)= \sum_{m= 0}^{N-1} f(m) \cos(\frac{n\pi}{N}(m+ \frac{1}{2}))$$
	\end{prop}
	\obs Y esto es lo que más se utiliza en tratamiento de señales de sonido, imagen....
\end{itemize}
