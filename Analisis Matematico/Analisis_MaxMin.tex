\section{Máximos y mínimos condicionados}

\begin{defn}[Extremo \IS condicional]
$\Omega\subset\real^n$, abierto, $\appl{F}{\Omega}{\real}$ y M subvariedad de $\real^n, M\subset \Omega$

\textbf{Definición:}

\begin{itemize}
\item $F$ alcanza en $\ga\in M$ un extremo local condicionado a $M \dimplies$ existe un abierto \[U\in\real^n\, con \, \ga\in U \tlq \left\{\begin{matrix} F(\gx) \leq F(\ga), \forall \gx \in U\cap M \\
F(\gx) \geq F(\ga), \forall \gx \in u\cap M \end{matrix}\right.\]
\end{itemize}

\end{defn}


\begin{theorem}[Teorema\IS Multiplicadores de Lagrange]
$\appl{F}{\Omega\subset\rnk}{\real}, F\in C^1(\Omega)$.

M, variedad n-dimensional en $\rnk$. $\ga\in M$ extremo local de $F$ condicionado a M.

Supongamos que en un entorno de $\ga$:

$M = \{G = \gor{0}\} y \, rg(DG)=max$

\textbf{Entonces:} Existen $\lambda_1,...,\lambda_k \in \real$ tales que
\[\nabla F(\ga) = \sum \lambda_i \nabla G_i (\ga)\]
\end{theorem}

\begin{proof}
$\ga \in M$. Consideremos $T_{\ga}M = \ker [DG(\ga)]$

\[DG(\ga) = \begin{pmatrix}
\nabla G_1(\ga) &\longrightarrow \\
\nabla G_2(\ga) &\longrightarrow \\
\vdots\\
\nabla G_k(\ga) &\longrightarrow 
\end{pmatrix}\]

Sea $\gv \in T_{\ga M}$. Entonces $DG(\ga)\cdot\gv = \gor{0}\in\real^K$

Este producto es como \[\begin{pmatrix}
\pesc{\nabla G_1(\ga),\gv}\\
\pesc{\nabla G_2(\ga),\gv}\\
\vdots\\
\pesc{\nabla G_k(\ga),\gv}
\end{pmatrix}\]

Podemos concluir que $\nabla G_j(\ga)\perp T_{\ga} M \forall j=1,...,k$, es decir $\nabla G_j(\ga) \in (T_{\ga}M)^\perp,\forall j=1,...,k$

La condición de rango máximo nos asegura que 
\[\{\nabla G_i, i = 1,...,n\} \text{ es una base de } (T_{\ga} M)^\perp\]

Ahora solo falta probar que  $\gv \in T_{\ga} M \implies \nabla F(\ga)\perp\gv$, es decir $\nabla F(\ga) \in (T_{\ga} M)^\perp$.

\[\gv \in T_{\ga} M \implies \exists \appl{\alpha}{\real}{M} \alpha \in C^1, \alpha(0) = \ga, \alpha'(0) = \gv\]

Definimos $g(t) = F(\alpha(t))$

$F$ extremo en $\ga \implies g$ extremo en $t=0$.

\[ 0 = g'(0) = DF(\alpha(0))\cdot \alpha'(0) = \pesc{\nabla F(\alpha(0)),gv} = \pesc{\nabla F(\ga),gv}\]

Conclusión $ 0 = \pesc{\nabla F(\ga),gv} \implies \nabla F(\ga) \in (T_{\ga}M)^\perp$

\end{proof}


\paragraph{Ejemplos:}

\subparagraph{1)} $F(x,y) = x^2-y^2$. Sea $M = \{x^2+y^2 = 1\}$.

%Revisar. Falta pintar la circunferencia
%\easyimg{imgs/MCNSM.png}{Mapa de conjuntos de nivel de la silla de montar}{lblMCNSM}

%Si calculamos el máximo y el mínimo condicionados a la circunferencia de $R=1$ vemos que $\nabla F$ es paralelo al radio de la circunferencia, como consecuencia de la tangencia entre el conjunto de nivel y la subvariedad $M$. 

\begin{itemize}
\item $M$ es cerrado y acotado, es decir $M$ es compacto, $G^{-1}({0}) \equiv M, G(x,y) = x^2+y^2-1$
\item F continua
\end{itemize}

 $\implies$ se alcanza máximo y mínimo.


\textbf{Vamos con los multiplicadores.}

$\nabla F = (2x,-2y), \nabla G(2x,2y)$

El sistema queda:

\[\left\{\begin{array}{cc}
2x &= \lambda_1 2x  \\
2y &= -\lambda_2 2y\\
x^2+y^2 &= 1
\end{array}\right\}\]

La ecuación 1 nos da 2 casos:
\[\left\{\begin{array}{cc}
caso\, 1 & \lambda = 1\\
caso\, 2 & \lambda = 0
\end{array}\right\}\]

En el caso $\lambda = 1$

\[\left\{\begin{array}{cc}2x&=2x\\2y&=-2y\\x^2+y^2&=1\end{array}\right\} \implies x=\pm 1\]

Puntos críticos: $(1,0),(-1,0)$ con $F(\pm 1,0) = 1 \implies MAX$

En el caso $\lambda = 0$.

\[ \left\{\begin{array}{cc}
x &= 0\\
-2y &= \lambda 2y \\
y^2 &= 1
\end{array}\right\}\dimplies
\left\{ \begin{array}{cc}
y &= \pm 1\\
\lambda &= -1
\end{array}\right\}\]

Puntos críticos: $(0,1),(0,-1)$, con $F(0,\pm 1) = -1 \implies MIN$

\subparagraph{Ejemplo 2)}

Hallar los puntos críticos más cercanos al origen entre los contenidos en la curva
\[\Gamma = \left\{ \begin{array}{cc} x^2+xy+y^2-z^2-1&=0\\x^2+y^2-1&=0\end{array}\right.\]

En este caso: $M = \Gamma$ y tomamos $F(x,y,z) = x^2+y^2+z^2$ y $G(x,y,z) = (x^2+xy+y^2-z^2-1,x^2+y^2-1)$

\subparagraph{1) Compacidad}

$\Gamma$ es un conjunto cerrado porque las 2 ecuaciones definen un cerrado, y la intersección de 2 cerrados es un cerrado. Además está acotado porque e2 acota $x$ e $y$, y la e1 acota la z teniendo acotadas $x$ e $y$.

\subparagraph{2) Continuidad}

$F$ es continua.


Vamos con los multiplicadores:

\[
\left\{
\begin{array}{cl}
2x &= \lambda_1(2x+2y)+ \lambda_2 2x\\
2y &= \lambda_1(x+2y) + \lambda_2 2y\\
2z &= \lambda_1(-2z)\\
x^2+xy+y^2-z^2& = 1\\
x^2+y^2 &= 1
\end{array}\right\}\]
La tercera ecuación distingue 2 casos:
\[
\rightarrow
\left\{\begin{array}{cl}
Caso\, 1 &z=0\\
Caso\, 2 &\lambda_1 = -1\\
\end{array}\right.\]

\textbf{Caso 1:}

\[\left\{
\begin{array}{cl}
2x &= \lambda_1(2x+2y) + \lambda_2 2x\\
2y &= \lambda_1(x+2y) + \lambda_2 2y\\
x^2+xy+y^2& = 1\\
x^2+y^2 &= 1
\end{array}\right\}\]

De las últimas 2 ecuaciones vemos que $xy=0$. Distinguimos casos:

\[\left\{\begin{array}{ccc}
Caso\, 1.1& x=0 &\rightarrow y = \pm 1\\
Caso\, 1.2& y=0 &\rightarrow x = \pm 1
\end{array}\right\}\]

Tenemos 4 puntos críticos $P_1 = \{(1,0,0),(0,1,0),(-1,0,0),(0,-1,0)\}$ con $F(x,y,z) = 1, \forall (x,y,z)\in P_1$-

\textbf{Caso 2:}


\[\left\{\begin{array}{cc}
2x&= -(2x+y) + \lambda_2 2x\\
2y&= -(x+2y) + \lambda_1 2y\\
x^2+xy+y^2 -z^2 &= 1\\
x^2+y^2&=1
\end{array}\right\}\]

Las 2 ultimas ecuaciones nos dan que $xy = z^2 \neq 0 \implies x,y\neq 0$.

Podría darse el caso de que nos saliera la misma solución que en el caso 1. No preocuparse, es posible.

\[\left\{\begin{array}{cc}
2xy &= \left[-(2x+y)+\lambda_2 2x\right]y\\
2xy &= \left[-(x+2y)+\lambda_2 2y\right]x
\end{array}\right\}\]

Echate las cuentas lector vago y llegarás a:

\[P_2 = \left\{
\left(\frac{1}{\sqrt{2}},\frac{1}{\sqrt{2}},\frac{1}{\sqrt{2}}\right),
\left(\frac{-1}{\sqrt{2}},\frac{-1}{\sqrt{2}},\frac{1}{\sqrt{2}}\right),
\left(\frac{1}{\sqrt{2}},\frac{1}{\sqrt{2}},\frac{-1}{\sqrt{2}}\right),
\left(\frac{-1}{\sqrt{2}},\frac{-1}{\sqrt{2}},\frac{-1}{\sqrt{2}}\right)
\right\}\] con $F(x,y,z) = \frac{3}{2}, \forall (x,y,z)\in P_2$

Jodete guille


\tdplotsetmaincoords{70}{110}
\begin{tikzpicture}[scale=3,tdplot_main_coords]
    \def\x{.5}
    \draw[thin] (0,0,0) -- ({1.2*\x},{sqrt(3)*1.2*\x},0) node[below] {$y=\sqrt{3}x$};
    \filldraw[
        draw=red,%
        fill=red!20,%
    ]          (0,0,0)
            -- (\x,{sqrt(3)*\x},0)
            -- (\x,{sqrt(3)*\x},1)
            -- (0,0,1)
            -- cycle;
    \draw[thick,->] (-2,0,0) -- (2,0,0) node[anchor=north east]{$x$};
    \draw[thick,->] (0,-1,0) -- (0,1,0) node[anchor=north west]{$y$};
    \draw[thick,->] (0,0,-1) -- (0,0,1) node[anchor=south]{$z$};
\end{tikzpicture}

