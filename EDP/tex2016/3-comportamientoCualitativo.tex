% -*- root: ../EDP2016.tex -*-
\chapter{Comportamiento cualitativo}

% clase 15/3/2016

En este capítulo vamos a ver:

\begin{itemize}

	\item ondas (hiperbólica)
	\item calor (parabólica)
	\item laplace (elípticas)

\end{itemize}


\section{Ondas}

	Hemos visto ya el problema en dimensión 1: la cuerda vibrante.

	Hemos visto también el método de separación de variables que solo nos valdrá en un dominio acotado. Pero ¿qué podemos hacer en dominios no acotados? y ¿Hay más soluciones?.

	Después vimos al fórmula D'Alambert \ref{eq:DALEMBERT}, que si que nos sirve para dominios no acotados pero es difícil de interpretar en dominios acotados. Veamos un ejemplo de esta afirmación:

	\begin{example}

		\[\begin{cases}
			u_{tt} - u_{xx} = 0, x \in (0,L) t > 0 \\
			u(0,t) = u(L,t) = 0, t > 0\\
			u(x,0) = f(x) \\
			u_t(x,0) = 0
		\end{cases}\]

		Y tenemos la fórmula a la que llegamos:

		\[ u(x,t) = \frac{1}{2} \{f(x+t)+f(x-t)\}  \]

		Resulta que tenemos una fórmula muy útil pero ocurre que en un dominio acotado no podemos calcular $f$ cerca del borde al realizar $x+t$ o $x-t$. Tenemos que encontrar una manera de extender $f$ de manera que esté de acuerdo con el contorno. No es lo mismo que una cuerda esté sujeta y la onda se refleje de una manera de vuelta en la cuerda a que no esté sujeta.

		\begin{center}
			\begin{tikzpicture}
			\draw[-] (-1,0) -- (3,0);
			\draw[-] (0,-0.5) -- (0,2);


			\draw[dashed] (1.5,0) node [below] {$L$} -- (1.5,1.5);

			\draw[thick, blue] plot[smooth, tension=.9] coordinates{(0.7,0) (0.8,0.2) (1,0.4) (1.2,0.7) (1.5,0.9)};

			\end{tikzpicture}
		\end{center}

	\end{example}


	\subsection{Unicidad}

		\[\begin{cases}
		   u_{tt}-u_{xx} = 0, x \in (0,L), t >0\\
		   \text{contorno} \begin{cases}
		   	\text{dirichlet}\\
		   	\text{neumann}\\
		   	\text{periódicas}
		   \end{cases}\\
		   \begin{cases}
		   u(x,0) = 0 \\
		   u_t (x,0) = 0
		   \end{cases}
		\end{cases}
		 \]


		 $u_1, u_{2}$ son soluciones. $u = u_1 - u_2$ es solución + contorno + datos $\equiv$ 0. Queremos probar que $u\equiv0$


		 \[ \int_{0}^{L} u_t (u_{tt}- u_{xx}) dx = 0 \]

		 \[ \int_0^L \underbrace{u_t u_{tt}}_{\frac{1}{2}(u^2_t)_t} - u_t u_{xx} dx  \]

		 Operamos por partes:

		 \[ \int_0^L  \underbrace{u_t}_{u} \underbrace{u_{xx}}_{dv}  dx = \left. u_t u_x \right|_{x=0}^{L} - \int_0^L \underbrace{u_x u_{tx}}_{\frac{1}{2}(u_x^2)_t} dx \]

		 Y volviendo tenemos que:

		 \[  \int^{L}_{0} \frac{1}{2} (u_t^2)_t dx  \]

		 (FALTA)


		 \textbf{Conclusión}

		 \[ E(t) = \frac{1}{2} \int_{0}^L u_t^2(x,t) + u_x^2(x,t) dx \]

		 \[ E'(t) = 0 \forall t \quad \text{Conservación de energía total}\]


		 \[ E(t) = E(0) = \frac{1}{2} \int_0^L u_t^2 (x,0) + u_x^2 (x,0) dx = \frac{1}{2} \int_0^L g^2(x)+(f'(x))^2 dx \eqreason{$f=g=0$} = 0 \]

		 \[ E=0 \Rightarrow u_t = u_x = 0 \Rightarrow u \equiv \text{cte. y } u(x,0) = 0 \Rightarrow u \equiv 0\]

		 Por lo tanto hemos demostrado que las dos soluciones son iguales y por lo tanto solo hay una solución.

		 Tenemos también:

		 \[ E(t) =  \frac{1}{2}\int_0^L (u_t)^2 + (u_x)^2 dx \rightarrow E'(t) = u_t (L,t) u_x(L,t) - u_t(0,t) u_x(0,t) \]

		 Veamos que pasa dependiendo del tipo de contorno que tengamos:

		 \begin{itemize}
		 	\item Contorno Dirichlet
		 		\[ u(0,t) = u(L,t) = 0, \forall t \Rightarrow u_t (0,t) = u_t(L,t) = 0 \forall t \Rightarrow E'(t) = 0 \]

		 	\item Controno Neumann
		 		\[ u_x(0,t) = u_x(L,t) = 0, \forall t \Rightarrow  E'(t) = 0 \]

		 	\item Periódicas
		 		\[ u(0,t) = u(L,t), \forall t \Rightarrow u_t (0,t) = u_t(L,t) \forall t \quad \text{y} \quad u_x(0,t) = u_x(L,t), \forall t \Rightarrow E'(t) = 0 \]

		 	\item mixtas

		 \end{itemize}

		 Este resultado es la \concept{conservación de la energía}:

		 \[E(t) = \text{cte.} = E(0) = \frac{1}{2} \int_0^L (g(x))^2 + (f'(x))^2 dx  \]

		 \textbf{Consecuencias:}

		 	Veamos el caso Dirichlet, pero esto es válido para todos:

		 	\[ \begin{cases}
		 		u_{tt} - u_{xx} = F(x,t)\\
		 		u(0,t) = \alpha(t), u(L,t) = \beta{t} \\
		 		u(x,0) = f(x) \\
		 		u_t(x,0) = g(x)
		 	\end{cases}\]
		 	\[u_1,u_2 \in C^2 \text{ soluciones}\]

		 	En este problema no tenemos conservación, debido a $\alpha$, $\beta$ y $F(x,t)$ pero podemos transformarlo en un problema de $W$ en donde si tengamos esta propiedad:

		 	\[\begin{cases}
		 		W = u_1 - u_2 \\
		 		W_{tt} - W_{xx} = 0 \\
		 		W(0,t) = 0 = W(L,t) \\
		 		W(x,0) = 0 \\
		 		W_t(x,0)
		 	\end{cases}\]

		 	Por conservación de la energía tenemos:

		 	\[ \int_0^L (W_t)^2 + (W_x)^2 dx = 0 \Rightarrow W_t = W_x = 0 \Rightarrow W \equiv \text{cte.} \eqreason[\Rightarrow]{$W|_{t=0} = 0$} W(x,t) = 0 \forall x \forall t \Rightarrow u_1 = u_2 \]

		 	Por lo que hemos obtenido unicidad de las soluciones del problema inicial. Pero aunque sepamos que la solución es única, no sabemos si existe tal solución. Volvemos al problema inicial:

		 	\[ \begin{cases}
		 		u_{tt} - u_{xx} = F(x,t)\\
		 		u(0,t) = \alpha(t), u(L,t) = \beta{t} \\
		 		u(x,0) = f(x) \\
		 		u_t(x,0) = g(x)
		 	\end{cases}\]


		 	\[ C(x,t) \text{ tq. } C(0,t) = \alpha(t), C(L,t) = \beta{t}\]

		 	Por ejemplo: $C(x,t) = \alpha(t) + \frac{x}{L} (\beta(t)-\alpha(t))$

		 	Consideramos $v(x,t) = u(x,t) - c(x,t)$ (de modo que $v(0,t) = v(L,t) = 0$)

		 	\[\begin{cases}
		 		v_{tt} - v_{xx} = u_{tt} - c_{tt} - u_{xx} + c_{xx} = F - c_{tt} + c_{xx} = \gor{F} \\
		 		v(0,t) = v(L,t) = 0 \\
		 		v(x,0) = u(x,0) - c(x,0) = f(x) - c(x,0) = \gor{f}(x) \\
		 		u_t (x,0) = … = \gor{g}(x)
		 	\end{cases}
		 	\]

		 	Reescribimos nuestro sistema inicial con $v$ y obtenemos:

		 	\[ \begin{cases}
		 		v_{tt} - v_{xx} = \gor{F}(x,t)\\
		 		v(0,t) = 0, v(L,t) = 0 \\
		 		v(x,0) = \gor{f}(x) \\
		 		v_t(x,0) = \gor{g}(x)
		 	\end{cases}\]

		 	Tomando $v = H + W$ podemos separar nuestro problema en dos:

		 	\[ \begin{cases}
		 			H(x,t) \rightarrow
		 			\begin{cases}
				 		H_{tt} - H_{xx} = 0\\
				 		H(0,t) = H(L,t) = 0 \\
				 		H(x,0) = \gor{f}(x) \\
				 		H_t(x,0) = \gor{g}(x)
			 		\end{cases}\\
			 		W(x,t) \rightarrow
			 		\begin{cases}
				 		W_{tt} - W_{xx} = \gor{F}(x,t)\\
				 		W(0,t) = 0 = W(L,t) \\
				 		W(x,0) = 0 \\
				 		W_t(x,0) = 0
				 	\end{cases}
				 \end{cases}
			\]

			El sistema de la $H$ ya lo sabemos resolver por separación de variables, Fourier...

			El problema de la $W$ lo resolvemos aplicando Duhamel (método del impulso). Fijamos $s>0$:

			\[\begin{cases}
				\left.
				\begin{array}{l}
					\Phi_{tt} - \Phi_{xx} = 0 \\
					\Phi(0,t) = \Phi(L,t) = 0 \\
					\Phi(x,0) = 0 \\
				\end{array}
				\right| (FALTA) \\
				\Phi_t(x,0) = \gor{F}(x,s)
			\end{cases}\]


			\textbf{Notación:}


			\[ \Phi = \Phi(x,t,s)\]

			Respuesta al impulso $\gor{F}(x,s)$ que actúa en $t=0$.

			\[ \Phi(x,t-s,s)\]

			Respuesta al impulso $\gor{F} (x,s)$ que actúa en $t-s = 0$ ($t=s$)

			Aplicando Duhamel:

			\[ W(x,t) = \int_0^t \Phi(x,t-s,s) ds \]

			\[ G(x,t,z) = \int_0^z \Phi(x,t-s,s) ds\]
			\[ G_t = \int_0^z \Phi_t (x,t-s,s) ds \]
			\[ G_z = \Phi(x,t-z,z) \]
			\[ W(x,t) = G(x,t,t)\]
			\[ W_t = G_t + G_z z_t = G_t(x,t,t) + G_z (x,t,t) \cdot 1\]

			\[ W_t(x,t) = \Phi(x,0,t)+ \int_0^t \Phi_t (x,t-s,s) ds\]
			\[ W_{tt} = \Phi_{s} (x,0,t) + \Phi_t(x,0,t) + \int_0^t \Phi_{tt} (x,t-s,s) ds  \]
			\[ W_{xx} = \int_0^L \phi_{xx} (x,t-s,s) ds \]
			\[ W_{tt} - W_{xx} = \Phi_{s}(x,0,t) + \Phi_t(x,0,t) + \int_0^L \phi_{tt} - \Phi_{xx} dx \]

			\[ W(0,t) = \int_0^t \underbrace{\Phi(0,t-s,s)}_{\equiv 0} ds = 0  \]
			\[ W(L,t) = \int_0^t \Phi(L,t-s,s) ds = 0 \]

			\[ W(x,0) = \int_0^0 \Phi(x,0-s,s) ds = 0 \]
			\[ W_t (x,0) = 0\]

			Nos hemos dejado el lado derecho de la ecuación, que es:

			\[\Phi_s (x,0,t) + \underbrace{\Phi_t(x,0,t)}_{\gor{F}(x,t)} \]

			Finalmente:

			\[ \Phi(x,0,s) = 0, \forall s \Rightarrow \Phi_s (x,0,s) = 0 \forall s  \]
			\[ \Phi_t(x,0,s) = \gor{F}(x,s), \forall s \]

			Hemos descompuesto el problema en cuatro problemas más pequeños. Y hemos resuelto cada uno, completándolo con este último. La suma de ellos será una solución del primero, y además sabemos que es única por el resultado obtenido antes.

			Ahora veamos que pasa con otras condiciones de contorno:

			\[ \begin{cases}
		 		u_{tt} - u_{xx} = F(x,t)\\
		 		u(0,t) = \alpha(t), u(L,t) = \beta(t) \\
		 		u(x,0) = f(x) \\
		 		u_t(x,0) = g(x)
		 	\end{cases}\]

		 	Lo cual cambiamos al problema:

		 	\[ \begin{cases}
		 		v_{tt} - v_{xx} = F(x,t)\\
		 		v(0,t) = \alpha(t), v(L,t) = \beta(t) \\
		 		v(x,0) = \gor{f}(x) \\
		 		v_t(x,0) = \gor{g}(x)
		 	\end{cases}\]

		 	Y llegamos igual que antes hasta el problema de $W$ ($W = u-v$):

		 	\[ \begin{cases}
		 		W_{tt} - W_{xx} = 0\\
		 		W(0,t) = 0 = W(L,t) \\
		 		W(x,0) = f - \gor{f} \\
		 		W_t(x,0) = g-  \gor{g}
		 	\end{cases}\]

		 	Por conservación de la energía:

		 	\[ \frac{1}{2} \int_0^L (W_t)^2 + (W_x)^2 dx = \frac{1}{2} \int_0^L (g-\gor{g})^2 + ((f-\gor{f})')^2 dx \]

		 	Hemos demostrado también dependencia continua de datos. Lo que quiere decir que datos pequeños nos llevan a energías pequeñas.

		 	Y por lo tanto acabamos diciendo que el problema de las ondas es un problema bien propuesto: tiene existencia, unicidad y dependencia contínua.


		 	% Clase gjulianm 29/3

		\subsection{Deducción de la ecuación de onda}

		\begin{figure}[hbtp]
		\centering
		\inputtikz{TensionCuerda}
		\caption{Esquema para la demostración, dejando sólo un trozo de cuerda y sustituyendo por la tensión.}
		\label{fig:TensionCuerda}
		\end{figure}

		La idea para la deducción de la ecuación de onda es la siguiente: quitar un cacho de cuerda y sustituirlo por una tensión $T(x,t)$, que representa el efecto del trozo de cuerda a la derecha del punto $x$ en el instante $t$.

		Las componentes horizontales están en equilibrio, luego tienen que anularse: \( T(x+h) \cos θ(x+h) - T(x) \cos θ(x) = 0 \label{eq:Onda:EquilibrioHorizontal} \)

		Las componentes verticales tienen que seguir la Ley de Newton: \( T(x + h) \sin θ(x+h) - T(x) \sin θ(x) = m · u_{tt} \label{eq:Onda:LeyNewton} \), donde $m$ es la masa que se calcula a partir de la densidad ρ (constante) y de la longitud de la curva: \[ m = ρ \int_{x}^{x+h} \sqrt{1+u_x^2} \dif s\]

		Para hacer la deducción de la ecuación, dividiremos entre $h$ en \eqref{eq:Onda:LeyNewton}, y haciendo tender $h \to 0$ tenemos la derivada: \[ \left(T(x) \sin θ(x)\right)_x = ρ\sqrt{1+u_x^2(x,t)} u_{tt} \]

		Haciendo el truco de escribir $\sin θ = \cos θ · \tan θ$, tenemos que $\tan θ = u_x$ y nos queda lo siguiente:  \[ \left(T(x) \cos θ(x) u_x \right)_x = ρ\sqrt{1+u_x^2(x,t)} u_{tt} \]

		Ahora derivamos y vemos qué ocurre: \[ \left(T(x) \cos θ(x) u_x \right)_x = \left(T(x) \cos θ(x)\right)_x u_x + T(x) \cos θ(x) u_{xx} \]

		Podemos simplificar viendo que \eqref{eq:Onda:EquilibrioHorizontal} nos decía que $T(x+h) \cos θ(x+h) - T(x) \cos θ(x) = 0$, luego $(T(x) \cos θ(x))_x = 0$. Además, por no sé equé tenemos que $T(x) \cos θ(x)$ es constante.

		Sólo nos falta quitarnos la raíz esa fea. Para ello hacemos la simplificación de tener oscilaciones pequeñas, de tal forma que $u_x$ es pequeño, $u_x^2$ es todavía más pequeño y $1 + u_x^2 \approx 1$. Así, nos queda la ecuación que ya conocemos: \[ u_{tt} - c^2 u_{xx} = 0\]

		\subsection{Ecuación de ondas en $ℝ$}

		Partimos de nuestra ecuación homogénea: \[ \begin{cases}
		u_{tt} - c^2 u_{xx} = 0 \\
		u(x,0) = f(x) \\
		u_t(x, 0) = g(x)
		\end{cases}\]

		La cuestión es que aquí no podemos aplicar las series de Fourier, porque no tenemos una longitud acotada: estamos estudiando la ecuación en todo $ℝ$. Lo que haremos será ver si aplicando la Fórmula de D'Alembert nos sale algo. Para eso, hacemos el siguiente cambio de variables: \begin{align*}
		ξ &= x + ct & ξ_x = 1,\,& ξ_t = c \\
		η &= x - ct & η_x = 1,\,& η_t = - c \\
		\end{align*}

		Haciendo las cuentas tenemos lo siguiente: \begin{align*}
		u_x &= u_ξ + u_η \\
		u_{xx} &= u_{ξξ} + 2 u_{ηξ} + u_{ηη} \\
		u_t &= c u_ξ - c u_η \\
		u_{tt} &= c^2 u_{ξξ} + 2c^2 u_{ηξ} + c^2 u_{ηη}
		\end{align*}

		La conclusión de todo esto es que la ecuación nos queda así: \[ 0 = u_{tt} - c^2 u_{xx} = -4c^2 u_{ηξ} \], de tal forma que la ecuación final nos queda muy simple: \[ u_{ηξ} = 0\]

		De ahí podemos sacar fácilmente que $u_η = α(η)$, una función que sólo depende de $η$. Por tanto, podemos sacar la fórmula para $u$: \[ u = \int α(η) \dif η + B(ξ) = A(η) + B(ξ) = A(x-ct) + B(x+ct)\]

		Si $u(x,0) = f(x)$, entonces $f(x) = A(x) + B(x)$, y si $u_t(x,0) = g(x)$ entonces $g(x) = -cA'(x) + cB'(x)$. El sistema resultante es el siguiente: \[ \begin{cases}
		A' + B' = f \\
		-A' + B' = \dfrac{1}{c} g
		\end{cases} \]

		Resolviéndolo, llegaremos de nuevo a la fórmula de D'Alembert: \( u(x,t) = \frac{1}{2} \left(f(x + ct) + f(x-ct)\right) + \frac{1}{2c} \int_{x-ct}^{x+ct} g(s) \dif s \label{eq:Onda:DAlembert} \)

		A partir de aquí podemos encontrar algunas consecuencias y estudiar la función de onda. Lo primero es ver que la única solución del problema en todo $ℝ$ viene dada por esta fórmula: no hemos introducido ni quitado nuevas soluciones.

		\begin{figure}[hbtp]
		\centering
		\inputtikz{ReprGraficaEcOnda}
		\caption{Representación gráfica y dominio de dependendencia de la solución y de influencia de los datos.}
		\label{fig:ReprGraficaEcOnda}
		\end{figure}

		Lo siguiente es estudiar lo que se ve en la \fref{fig:ReprGraficaEcOnda}. $u(x,t)$ sólo dependerá de los valores de $f$ en los puntos $a,b$ y del valor de $g$ en el intervalo $(a,b)$. La zona sombreada en la figura será el dominio de influencia del intervalo $[a,b]$: es sólo ahí donde influyen los datos de $f,g$ de esos puntos. Por ejemplo, si en $t = 0$ $f = g \equiv 0$ fuera de $[a,b]$, entonces en $t = T$ la solución será cero fuera de $[a - cT, b + cT]$. En otras palabras, hay una velocidad de propagación finita de los datos.

		La aplicación de esto es la demostración de la conservación de la energía. Partíamos de una ecuación \[ E(t) = \frac{1}{2} \int_{-∞}^∞ u_x^2 \dif x + \frac{c^2}{2} \int_{-∞}^∞ u_t^2 \dif x\], y derivando y haciendo cuentas nos salía que \[ E'(t) = \int_{-∞}^∞ u_t(u_{tt} - c^2 u_{xx}) \dif x = 0\], luego la energía se conservaba.

		Ahora bien, cuando hacíamos eso en dominios acotados, lo que necesitamos era la hipótesis de los valores de contorno para poder demostrar que salía lo que tenía que salir. Aquí lo que necesitaremos simplemente es que $f(x)$ y $g(x)$ sean funciones de soporte compacto (son $0$ fuera de un intervalo $[-M, M]$), de tal forma que para tiempos finitos se cumple que en el instante $t$, $u(x,t)$ es $0$ fuera del intervalo $[-M - ct, M + ct]$ y por tanto los términos de borde en la integración por partes para sacar $E'(t)$ se anulan.

		Como nota, no podríamos pedir sólo que $u_x$ y $u_t$ fuesen integrables $L^2$, más que nada porque eso no implica que se vayan a $0$ en $∞$.

		La conservación de la energía nos dará unicidad de solución, también para el problema no homogéneo; y dependencia continua de los datos. Estos resultados habría que compararlos con el teorema en dominios acotados, que es donde lo demostrarmos en su día.

		Y luego una prueba de algo con un paralelogramo del que no me he llegado a enterar demasiado bien:

		\begin{figure}[hbtp]
		\centering
		\inputtikz{Paralelogramo}
		\caption{Paralelogramo.}
		\label{fig:Paralelogramo}
		\end{figure}
